(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-24e2611c"],{7176:function(e,t,a){},8186:function(e,t,a){"use strict";a("7176")},aa65:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"space-manage-vue",staticStyle:{"min-height":"100%"}},[a("el-breadcrumb",{staticStyle:{padding:"20px 10px"},attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[e._v("WIKI文档")]),a("el-breadcrumb-item",[e._v("空间管理")])],1),a("div",{staticStyle:{"max-width":"1200px",margin:"0 auto",background:"#fff",padding:"20px","min-height":"100%","box-sizing":"border-box"}},[a("div",{staticStyle:{"text-align":"right","margin-bottom":"10px"}},[a("span",{staticStyle:{float:"left","line-height":"40px"}},[e._v(" 仅展示我收藏的空间： "),a("el-switch",{attrs:{"inactive-value":"0","active-value":"1"},on:{change:e.wikiOnlyShowFavoriteChange},model:{value:e.userSetting.wiki_only_show_favorite,callback:function(t){e.$set(e.userSetting,"wiki_only_show_favorite",t)},expression:"userSetting.wiki_only_show_favorite"}}),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"控制左上角空间下拉列表仅展示我收藏的空间",placement:"top-start"}},[a("i",{staticClass:"el-icon-warning-outline",staticStyle:{"vertical-align":"middle","margin-left":"10px",color:"#999"}})])],1),a("el-button",{attrs:{icon:"refresh",loading:e.spaceListLoading},on:{click:e.loadSpaceList}},[e._v("刷新")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.showCreateSpace}},[e._v("创建空间")])],1),a("el-table",{staticStyle:{width:"100%","margin-bottom":"5px"},attrs:{data:e.spaceList,border:""}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"60"}}),a("el-table-column",{attrs:{prop:"name",label:"名字"}}),a("el-table-column",{attrs:{prop:"spaceExplain",label:"说明"}}),a("el-table-column",{attrs:{label:"开放地址"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.openDoc?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showOpenSpace(t.row.uuid)}}},[e._v(e._s(t.row.name))]):a("span",[e._v("暂未开放")])]}}])}),a("el-table-column",{attrs:{prop:"createUserName",label:"创建人"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间"}}),a("el-table-column",{attrs:{prop:"favorite",label:"收藏",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.favorite?a("i",{staticClass:"el-icon-star-on favorite-icon",on:{click:function(a){return e.updateSpaceFavorite(t.row)}}}):a("i",{staticClass:"el-icon-star-off favorite-icon",on:{click:function(a){return e.updateSpaceFavorite(t.row)}}})]}}])}),a("el-table-column",{attrs:{label:"操作",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return e.userSelfInfo.id==t.row.createUserId?[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return e.editSpaceInfo(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"small",type:"warning"},on:{click:function(a){return e.editSpaceAuth(t.row)}}},[e._v("授权")]),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){return e.deleteSpaceInfo(t.row)}}},[e._v("删除")])]:void 0}}],null,!0)})],1)],1),a("el-dialog",{attrs:{title:"权限管理",visible:e.spaceAuthDialogVisible,width:"900px"},on:{"update:visible":function(t){e.spaceAuthDialogVisible=t}}},[a("el-row",[a("el-select",{staticStyle:{width:"750px","margin-right":"10px"},attrs:{filterable:"",placeholder:"请选择分组"},model:{value:e.spaceAuthNewGroupId,callback:function(t){e.spaceAuthNewGroupId=t},expression:"spaceAuthNewGroupId"}},e._l(e.searchGroupList,(function(t){return a("el-option",{key:t.id,attrs:{label:e.searchGroupMap[t.id],value:t.id}})})),1),a("el-button",{on:{click:e.addSpaceAuthUserGroup}},[e._v("添加")])],1),a("el-table",{staticStyle:{width:"100%",margin:"10px 0"},attrs:{data:e.spaceAuthGroupList,border:""}},[a("el-table-column",{attrs:{prop:"groupId",label:"分组名",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.searchGroupMap[t.row.groupId]))]}}])}),a("el-table-column",{attrs:{label:"权限"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:t.row.editPage,callback:function(a){e.$set(t.row,"editPage",a)},expression:"scope.row.editPage"}},[e._v("编辑")]),a("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:t.row.deletePage,callback:function(a){e.$set(t.row,"deletePage",a)},expression:"scope.row.deletePage"}},[e._v("删除")]),a("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:t.row.pageFileUpload,callback:function(a){e.$set(t.row,"pageFileUpload",a)},expression:"scope.row.pageFileUpload"}},[e._v("文件上传")]),a("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:t.row.pageFileDelete,callback:function(a){e.$set(t.row,"pageFileDelete",a)},expression:"scope.row.pageFileDelete"}},[e._v("文件删除")]),a("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:t.row.pageAuthManage,callback:function(a){e.$set(t.row,"pageAuthManage",a)},expression:"scope.row.pageAuthManage"}},[e._v("权限管理")])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(a){return e.deleteGroupSpaceAuth(t.row)}}},[e._v("删除")])]}}])})],1),a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{on:{click:e.manageUserGroup}},[e._v("分组管理")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveGroupSpaceAuth}},[e._v("保存配置")])],1)],1),a("create-space",{ref:"createSpace",on:{success:e.loadSpaceList}})],1)},o=[],n=(a("7db0"),a("d3b7"),a("e9c4"),a("4de4"),a("159b"),a("b0c0"),a("0a79")),r=a("9f03"),s=a("c82a"),c={data:function(){return{spaceListLoading:!1,spaceOptions:[],spaceList:[],choiceSpace:"",nowSpaceShow:{},newSpaceDialogVisible:!1,manageSpaceDialogVisible:!1,newSpaceForm:{id:"",name:"",spaceExplain:"",treeLazyLoad:0,openDoc:0,uuid:"",type:1},newSpaceFormRules:{name:[{required:!0,message:"请输入空间名",trigger:"blur"},{min:2,max:25,message:"长度在 2 到 25 个字符",trigger:"blur"}]},userSelfInfo:{},editSpaceId:"",spaceAuthDialogVisible:!1,spaceAuthNewGroupId:"",spaceAuthGroupLoading:!1,searchGroupList:[],searchGroupMap:{},spaceAuthGroupList:[],userSetting:{wiki_only_show_favorite:0}}},components:{"create-space":s["a"]},mounted:function(){this.loadSpaceList(),this.getSelfUserInfo(),this.getSpaceSettingList()},methods:{showOpenSpace:function(e){var t=this.$router.resolve({path:"/page/share/home",query:{space:e}});window.open(t.href,"_blank")},showCreateSpace:function(){this.$refs.createSpace.show()},editSpaceInfo:function(e){this.$refs.createSpace.show(e.id)},addSpaceAuthUserGroup:function(){var e=this;this.spaceAuthNewGroupId?(this.spaceAuthGroupList.find((function(t){return t.groupId==e.spaceAuthNewGroupId}))||this.spaceAuthGroupList.push({groupId:this.spaceAuthNewGroupId,editPage:0,commentPage:0,deletePage:0,pageFileUpload:0,pageFileDelete:0,pageAuthManage:0}),this.spaceAuthNewGroupId=""):this.$message.warning("请先选择分组")},updateSpaceFavorite:function(e){var t=1==e.favorite?1:0;n["a"].spaceFavoriteUpdate({spaceId:e.id,delFlag:t}).then((function(t){e.favorite=1==e.favorite?0:1}))},saveGroupSpaceAuth:function(){var e=this,t={spaceId:this.editSpaceId,authList:JSON.stringify(this.spaceAuthGroupList)};n["a"].spaceAuthAssign(t).then((function(t){e.$message.success("授权成功！")}))},manageUserGroup:function(){var e=location.href.substring(0,location.href.indexOf("/doc-wiki"))+"#/console/userGroupList";window.open(e,"_blank")},deleteGroupSpaceAuth:function(e){this.spaceAuthGroupList=this.spaceAuthGroupList.filter((function(t){return t.groupId!=e.groupId}))},editSpaceAuth:function(e){var t=this;this.editSpaceId=e.id,this.spaceAuthNewGroupId="",this.spaceAuthGroupList=[],r["a"].userGroupList().then((function(e){t.searchGroupList=e.data||[],t.searchGroupList.forEach((function(e){return t.searchGroupMap[e.id]=e.name}))})),n["a"].spaceAuthList({spaceId:e.id}).then((function(e){t.spaceAuthGroupList=e.data||[],t.spaceAuthDialogVisible=!0}))},deleteSpaceInfo:function(e){var t=this;this.$confirm("确定要删除此空间及下面的所有文档吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={id:e.id,delFlag:1};n["a"].updateSpace(a).then((function(){t.$message.success("删除成功"),t.loadSpaceList(),t.$emit("loadSpace")}))}))},loadSpaceList:function(){var e=this;this.spaceListLoading=!0,n["a"].spaceList({ignoreFavorite:1}).then((function(t){e.spaceList=t.data||[],setTimeout((function(){return e.spaceListLoading=!1}),500)}))},wikiOnlyShowFavoriteChange:function(){var e=this,t={name:"wiki_only_show_favorite",value:this.userSetting.wiki_only_show_favorite};n["a"].spaceSettingUpdate(t).then((function(t){e.$emit("loadSpace")}))},getSpaceSettingList:function(){var e=this;n["a"].spaceSettingList().then((function(t){var a=t.data||{};e.userSetting={wiki_only_show_favorite:a.wiki_only_show_favorite||0}}))},getSelfUserInfo:function(){var e=this;r["a"].getSelfUserInfo().then((function(t){e.userSelfInfo=t.data}))}}},l=c,u=(a("8186"),a("2877")),p=Object(u["a"])(l,i,o,!1,null,null,null);t["default"]=p.exports},e9c4:function(e,t,a){var i=a("23e7"),o=a("da84"),n=a("d066"),r=a("2ba4"),s=a("e330"),c=a("d039"),l=o.Array,u=n("JSON","stringify"),p=s(/./.exec),d=s("".charAt),h=s("".charCodeAt),f=s("".replace),g=s(1..toString),w=/[\uD800-\uDFFF]/g,b=/^[\uD800-\uDBFF]$/,v=/^[\uDC00-\uDFFF]$/,S=function(e,t,a){var i=d(a,t-1),o=d(a,t+1);return p(b,e)&&!p(v,o)||p(v,e)&&!p(b,i)?"\\u"+g(h(e,0),16):e},m=c((function(){return'"\\udf06\\ud834"'!==u("\udf06\ud834")||'"\\udead"'!==u("\udead")}));u&&i({target:"JSON",stat:!0,forced:m},{stringify:function(e,t,a){for(var i=0,o=arguments.length,n=l(o);i<o;i++)n[i]=arguments[i];var s=r(u,null,n);return"string"==typeof s?f(s,w,S):s}})}}]);