var ne=Object.defineProperty,le=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var X=(u,a,_)=>a in u?ne(u,a,{enumerable:!0,configurable:!0,writable:!0,value:_}):u[a]=_,Y=(u,a)=>{for(var _ in a||(a={}))ie.call(a,_)&&X(u,_,a[_]);if(H)for(var _ of H(a))se.call(a,_)&&X(u,_,a[_]);return u},Z=(u,a)=>le(u,de(a));import{z as x,g as re}from"./custom.f7427cee.js";import{T as ce,I as ue,u as P,y as f,H as J,r as d,o as c,c as v,w as e,a as o,B as q,m as n,D as G,V as K,W as Q,X as _e,b as L,F as z,k as I,J as $,e as g,t as ee,Y as me}from"./vendor.1b910c8a.js";import{a as te}from"./index.7bf1ebec.js";import{m as he}from"./mavon-editor.ee685efd.js";import{_ as F}from"./main.a6c14cdf.js";const pe={components:{aceEditor:te,BranchesOutlined:ce,mavonEditor:he.exports.mavonEditor,InfoCircleOutlined:ue},setup(){P();let u=f({}),a=f(""),_=f(!1);const t=async()=>{if(!a.value){q.error("\u8BF7\u8F93\u5165\u5F00\u653E\u6587\u6863\u7684\u8BF4\u660E");return}x.apiDocUpdate({id:u.value.id,shareInstruction:a.value}).then(p=>{_.value=!1,q.success("\u4FDD\u5B58\u6210\u529F\uFF01")})},b=async p=>{_.value=!0,x.apiDocDetail({id:p}).then(i=>{u.value=i.data,a.value=i.data.shareInstruction})},k=(p,i)=>{},m=(p,i)=>(q.error("\u6682\u4E0D\u652F\u6301\u56FE\u7247\u4E0A\u4F20"),!1);return J(()=>{}),{editShareInstructionVisible:_,docEdit:u,shareInstruction:a,handleNewDocOk:t,editDoc:b,imageFilter:m,addMarkdownImage:k,toolbars:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!1,code:!0,table:!0,fullscreen:!0,readmodel:!0,undo:!0,redo:!0,trash:!0,save:!0,navigation:!0,alignleft:!0,aligncenter:!0,alignright:!0,subfield:!0,preview:!0}}}},fe=n(" \u7F16\u8F91\u5F00\u653E\u6587\u6863\u8BF4\u660E "),ge=n("\u6B64\u8BF4\u660E\u6587\u6863\u5C06\u5C55\u793A\u5728\u5F00\u653E\u6587\u6863\u7684\u9996\u9875\u5C55\u793A\uFF0C\u53EF\u70B9\u51FB\u2018\u67E5\u770B\u5F00\u653E\u6587\u6863\u2019\u67E5\u770B\u6548\u679C");function ve(u,a,_,t,b,k){const m=d("info-circle-outlined"),p=d("a-tooltip"),i=d("mavon-editor"),h=d("a-modal");return c(),v(h,{visible:t.editShareInstructionVisible,"onUpdate:visible":a[1]||(a[1]=w=>t.editShareInstructionVisible=w),onOk:t.handleNewDocOk,width:"90%",bodyStyle:{height:"calc(100vh - 300px)"}},{title:e(()=>[fe,o(p,{placement:"bottom"},{title:e(()=>[ge]),default:e(()=>[o(m)]),_:1})]),default:e(()=>[o(i,{ref:"mavonEditor",modelValue:t.shareInstruction,"onUpdate:modelValue":a[0]||(a[0]=w=>t.shareInstruction=w),toolbars:t.toolbars,externalLink:!1,onImgAdd:t.addMarkdownImage,imageFilter:t.imageFilter,style:{height:"100%"},placeholder:"\u8BF7\u5F55\u5165\u5F00\u653E\u6587\u6863\u8BF4\u660E"},null,8,["modelValue","toolbars","onImgAdd","imageFilter"])]),_:1},8,["visible","onOk","bodyStyle"])}var ye=F(pe,[["render",ve]]);const be={emits:["showMembers"],components:{aceEditor:te,EditShareInstruction:ye,DownOutlined:G,LinkOutlined:K,EditOutlined:Q},setup(u,{emit:a}){const _=P();let t=f([]),b=f(!1),k=f({docType:"",openVisit:"",docStatus:"",pageNum:1,pageSize:20}),m=f({pageSize:20,pageNum:1,total:0,showSizeChanger:!0,pageSizeOptions:["20","50","100"],showTotal:l=>`\u5171${l}\u6761`});const p=(l,y,V)=>{m.value.pageNum=l.current,m.value.pageSize=l.pageSize,k.value.pageNum=l.current,k.value.pageSize=l.pageSize,i()},i=async()=>{b.value=!0,x.apiDocList(k.value).then(l=>{setTimeout(()=>b.value=!1,500),t.value=l.data||[],m.value.total=l.total||0})};let h=f({}),w=f(),C=f(!1);const U=async()=>{w.value.validate().then(()=>{x.apiDocAdd(h.value).then(l=>{i(),C.value=!1,_.commit("addDocChangedNum")})}).catch(l=>{console.log("error",l)})},E=async()=>{C.value=!0,h.value={docType:1,openVisit:0,docStatus:1,isNew:1}},T=l=>{a("showMembers",l)},A=l=>{x.apiDocDetail({id:l.id}).then(y=>{h.value=y.data,C.value=!0})},M=async(l,y,V)=>{x.apiDocUpdate({id:l,docStatus:y,yn:V}).then(B=>{i(),_.commit("addDocChangedNum")})},O=async l=>M(l.id,null,0),D=l=>{l.shareUuid?l.openVisit!==1?q.warning("\u8BE5\u6587\u6863\u5C1A\u672A\u5F00\u542F\u5F00\u653E\u8BBF\u95EE\u529F\u80FD\uFF0C\u8BF7\u5728\u7F16\u8F91\u9875\u9009\u62E9\u5F00\u653E\u540E\u518D\u8BD5"):window.open(re()+"/doc-api#/share/home?uuid="+l.shareUuid):q.warning("\u8BF7\u5148\u4FDD\u5B58\u6587\u6863\u540E\u518D\u8BD5")},s=(l,y)=>{l.key==="shareView"?D(y):l.key==="shareInstruction"&&S.value.editDoc(y.id)};let S=f();return J(()=>{i()}),{searchParam:k,docList:t,docListLoading:b,newDocVisible:C,docEdit:h,newDocFormRef:w,searchDocList:i,openNewDoc:E,handleNewDocOk:U,deleteDoc:O,editDoc:A,showMembers:T,handleTableChange:p,openShareViewWindow:D,handleActionMenuClick:s,pagination:m,instruction:S,newDocRules:{name:[{required:!0,message:"\u8BF7\u8F93\u5165\u6587\u6863\u540D\u79F0",trigger:"change"}],docUrl:[{required:!0,message:"\u8BF7\u8F93\u5165\u6587\u6863\u5730\u5740",trigger:"change"}],jsonContent:[{required:!0,message:"\u8BF7\u8F93\u5165JSON\u683C\u5F0F\u7684swagger\u6587\u6863\u5185\u5BB9",trigger:"change"}],docType:[{type:"number",required:!0,message:"\u8BF7\u9009\u62E9\u6587\u6863\u7C7B\u578B",trigger:"change"}],openVisit:[{type:"number",required:!0,message:"\u8BF7\u9009\u62E9\u662F\u5426\u5F00\u653E\u8BBF\u95EE",trigger:"change"}],docStatus:[{type:"number",required:!0,message:"\u8BF7\u9009\u62E9\u6587\u6863\u72B6\u6001",trigger:"change"}]},docListColumns:[{title:"ID",dataIndex:"id",width:70},{title:"\u6587\u6863\u540D\u79F0",dataIndex:"name",width:250},{title:"\u6587\u6863\u7C7B\u578B",dataIndex:"docType",width:120},{title:"\u5F00\u653E\u8BBF\u95EE",dataIndex:"openVisit",width:90},{title:"\u72B6\u6001",dataIndex:"docStatus",width:90},{title:"\u6587\u6863\u5730\u5740",dataIndex:"docUrl"},{title:"\u76EE\u6807\u57DF\u540D",dataIndex:"rewriteDomain",width:250},{title:"\u64CD\u4F5C",dataIndex:"operation",fixed:"right",width:280}],aceEditorConfig:{wrap:!0,autoScrollEditorIntoView:!0,enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0,minLines:10,maxLines:15},swaggerDocDemo:`{
    "swagger": "2.0",
    "info": {},
    "host": "doc.zyplayer.com",
    "basePath":"/",
    "tags": [],
    "paths": {},
    "definitions": {}
}`,openApiDocDemo:`{
    "openapi": "3.0.3",
    "components": {}
    "servers": [],
    "paths": {},
    "info": {},
}`}}},we=n("\u5168\u90E8"),ke=n("URL\u6DFB\u52A0"),De=n("JSON\u5185\u5BB9"),Se=n("\u5168\u90E8"),Ie=n("\u5426"),Ce=n("\u662F"),xe=n("\u5168\u90E8"),Ue=n("\u542F\u7528"),Le=n("\u7981\u7528"),Ee=n("\u67E5\u8BE2"),Te=n("\u65B0\u5EFA"),Ae=n("\u7F16\u8F91"),Ve=n("\u6210\u5458\u7BA1\u7406"),ze=n("\u5220\u9664"),Me=n(" \u67E5\u770B\u5F00\u653E\u6587\u6863"),Oe=n(" \u7F16\u8F91\u5F00\u653E\u6587\u6863\u8BF4\u660E"),Ne=n("\u66F4\u591A"),qe=n("Swagger URL"),je=n("Swagger JSON"),Re=n("OpenApi JSON"),Fe=n("\u672A\u5F00\u653E"),Be=n("\u5DF2\u5F00\u653E"),Pe=n("\u542F\u7528"),Je=n("\u7981\u7528"),We=n("Swagger URL"),He=n("Swagger JSON"),Xe=n("OpenApi URL"),Ye=n("OpenApi JSON"),Ze=n("\u81EA\u5EFAAPI"),Ge=n(" \u67E5\u770B\u6587\u6863\u5730\u5740 "),Ke=g("p",null,"\u683C\u5F0F\u4E00\uFF1Ahttp://doc.zyplayer.com/v2/api-docs",-1),Qe=g("p",null,"\u683C\u5F0F\u4E8C\uFF1Ahttp://doc.zyplayer.com/swagger-resources",-1),$e=g("p",null,"\u683C\u5F0F\u4E09\uFF1Ahttp://doc.zyplayer.com/swagger-ui.html",-1),et=g("a",null,"\u793A\u4F8B",-1),tt=n(" \u67E5\u770B\u6587\u6863\u5185\u5BB9 "),ot=g("div",null,'\u652F\u6301\u4EE5\u4E0B\u683C\u5F0F\u7684Swagger\u6587\u6863\u5185\u5BB9\u8F93\u5165\uFF0C\u5176\u4E2D {"swagger": "2.0"} \u4E3A\u5FC5\u8981\u5C5E\u6027',-1),at={class:"lang-json"},nt=g("a",null,"\u8BF4\u660E",-1),lt=n(" \u67E5\u770B\u6587\u6863\u5730\u5740 "),dt=g("p",null,"\u683C\u5F0F\u4E00\uFF1Ahttp://doc.zyplayer.com/v3/api-docs",-1),it=g("a",null,"\u793A\u4F8B",-1),st=n(" \u67E5\u770B\u6587\u6863\u5185\u5BB9 "),rt=g("div",null,'\u652F\u6301\u4EE5\u4E0B\u683C\u5F0F\u7684OpenApi\u6587\u6863\u5185\u5BB9\u8F93\u5165\uFF0C\u5176\u4E2D {"openapi": "3.x.x"} \u4E3A\u5FC5\u8981\u5C5E\u6027',-1),ct={class:"lang-json"},ut=g("a",null,"\u8BF4\u660E",-1),_t=n(" \u76EE\u6807\u57DF\u540D "),mt=g("p",null,"\u5728\u6587\u6863\u7684\u5728\u7EBF\u8C03\u8BD5\u754C\u9762\uFF0C\u8BBF\u95EE\u7684\u57DF\u540D\u53EF\u4EE5\u521D\u59CB\u4E3A\u6B64\u5904\u5F55\u5165\u7684\u57DF\u540D\uFF0C\u800C\u975E\u6587\u6863\u672C\u8EAB\u7684\u57DF\u540D\u5730\u5740",-1),ht=g("p",null,"\u53EF\u4FBF\u4E8E\u4E0D\u540C\u73AF\u5883\u95F4\u7684\u63A5\u53E3\u6D4B\u8BD5\uFF0C\u4F8B\uFF1Ahttp://doc.zyplayer.com",-1),pt=g("a",null,"\u8BF4\u660E",-1),ft=n("\u5426"),gt=n("\u5F00\u653E\u8BBF\u95EE"),vt=n(" \u5F00\u653E\u8BBF\u95EE\u540E\u65E0\u9700\u767B\u5F55\u5373\u53EF\u901A\u8FC7"),yt=n("\u8BBF\u95EE\u8BE5\u6587\u6863\u4FE1\u606F "),bt=n("\u542F\u7528"),wt=n("\u7981\u7528");function kt(u,a,_,t,b,k){const m=d("a-select-option"),p=d("a-select"),i=d("a-form-item"),h=d("a-button"),w=d("a-form"),C=d("a-popconfirm"),U=d("link-outlined"),E=d("a-menu-item"),T=d("edit-outlined"),A=d("a-menu"),M=d("DownOutlined"),O=d("a-dropdown"),D=d("a-tag"),s=d("a-table"),S=d("a-input"),l=d("a-radio"),y=d("a-radio-group"),V=d("a-popover"),B=d("ace-editor"),oe=d("a-modal"),ae=d("EditShareInstruction"),W=_e("highlight");return c(),L(z,null,[o(w,{layout:"inline",style:{"margin-bottom":"20px"}},{default:e(()=>[o(i,{label:"\u6587\u6863\u7C7B\u578B"},{default:e(()=>[o(p,{placeholder:"\u8BF7\u9009\u62E9\u6587\u6863\u7C7B\u578B",value:t.searchParam.docType,"onUpdate:value":a[0]||(a[0]=r=>t.searchParam.docType=r),style:{width:"150px"}},{default:e(()=>[o(m,{value:""},{default:e(()=>[we]),_:1}),o(m,{value:1},{default:e(()=>[ke]),_:1}),o(m,{value:2},{default:e(()=>[De]),_:1})]),_:1},8,["value"])]),_:1}),o(i,{label:"\u5F00\u653E\u8BBF\u95EE"},{default:e(()=>[o(p,{placeholder:"\u8BF7\u9009\u62E9\u5F00\u653E\u8BBF\u95EE",value:t.searchParam.openVisit,"onUpdate:value":a[1]||(a[1]=r=>t.searchParam.openVisit=r),style:{width:"150px"}},{default:e(()=>[o(m,{value:""},{default:e(()=>[Se]),_:1}),o(m,{value:0},{default:e(()=>[Ie]),_:1}),o(m,{value:1},{default:e(()=>[Ce]),_:1})]),_:1},8,["value"])]),_:1}),o(i,{label:"\u72B6\u6001"},{default:e(()=>[o(p,{placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001",value:t.searchParam.docStatus,"onUpdate:value":a[2]||(a[2]=r=>t.searchParam.docStatus=r),style:{width:"150px"}},{default:e(()=>[o(m,{value:""},{default:e(()=>[xe]),_:1}),o(m,{value:1},{default:e(()=>[Ue]),_:1}),o(m,{value:2},{default:e(()=>[Le]),_:1})]),_:1},8,["value"])]),_:1}),o(i,null,{default:e(()=>[o(h,{onClick:t.searchDocList,type:"primary"},{default:e(()=>[Ee]),_:1},8,["onClick"]),o(h,{onClick:t.openNewDoc,style:{marginLeft:"8px"}},{default:e(()=>[Te]),_:1},8,["onClick"])]),_:1})]),_:1}),o(s,{dataSource:t.docList,columns:t.docListColumns,size:"middle",loading:t.docListLoading,pagination:t.pagination,onChange:t.handleTableChange,scroll:{x:1400,y:"calc(100vh - 300px)"}},{bodyCell:e(({column:r,text:N,record:j})=>[r.dataIndex==="operation"?(c(),L(z,{key:0},[o(h,{size:"small",type:"link",onClick:R=>t.editDoc(j)},{default:e(()=>[Ae]),_:2},1032,["onClick"]),j.authType===1?(c(),L(z,{key:0},[o(h,{size:"small",type:"link",onClick:R=>t.showMembers(j)},{default:e(()=>[Ve]),_:2},1032,["onClick"]),o(C,{title:"\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",onConfirm:R=>t.deleteDoc(j)},{default:e(()=>[o(h,{size:"small",type:"link",danger:""},{default:e(()=>[ze]),_:1})]),_:2},1032,["onConfirm"])],64)):I("",!0),o(O,{trigger:["click"]},{overlay:e(()=>[o(A,{onClick:R=>t.handleActionMenuClick(R,j)},{default:e(()=>[o(E,{key:"shareView"},{default:e(()=>[o(U),Me]),_:1}),o(E,{key:"shareInstruction"},{default:e(()=>[o(T),Oe]),_:1})]),_:2},1032,["onClick"])]),default:e(()=>[o(h,{type:"link",size:"small"},{default:e(()=>[Ne,o(M)]),_:1})]),_:2},1024)],64)):I("",!0),r.dataIndex==="docType"?(c(),L(z,{key:1},[N===1?(c(),v(D,{key:0,color:"red"},{default:e(()=>[qe]),_:1})):N===2?(c(),v(D,{key:1,color:"blue"},{default:e(()=>[je]),_:1})):N===4?(c(),v(D,{key:2,color:"green"},{default:e(()=>[Re]),_:1})):I("",!0)],64)):I("",!0),r.dataIndex==="openVisit"?(c(),L(z,{key:2},[N===0?(c(),v(D,{key:0,color:"pink"},{default:e(()=>[Fe]),_:1})):N===1?(c(),v(D,{key:1,color:"green"},{default:e(()=>[Be]),_:1})):I("",!0)],64)):I("",!0),r.dataIndex==="docStatus"?(c(),L(z,{key:3},[N===1?(c(),v(D,{key:0,color:"green"},{default:e(()=>[Pe]),_:1})):N===2?(c(),v(D,{key:1,color:"pink"},{default:e(()=>[Je]),_:1})):I("",!0)],64)):I("",!0)]),_:1},8,["dataSource","columns","loading","pagination","onChange","scroll"]),o(oe,{visible:t.newDocVisible,"onUpdate:visible":a[13]||(a[13]=r=>t.newDocVisible=r),title:t.docEdit.isNew?"\u65B0\u589E\u6587\u6863":"\u7F16\u8F91\u6587\u6863",onOk:t.handleNewDocOk,width:800},{default:e(()=>[o(w,{layout:"horizontal",ref:"newDocFormRef",rules:t.newDocRules,model:t.docEdit,"label-col":{span:4},"wrapper-col":{span:20}},{default:e(()=>[o(i,{label:"\u6587\u6863\u540D\u79F0",required:"",name:"name"},{default:e(()=>[o(S,{placeholder:"\u8BF7\u8F93\u5165\u6587\u6863\u540D\u79F0",value:t.docEdit.name,"onUpdate:value":a[3]||(a[3]=r=>t.docEdit.name=r)},null,8,["value"])]),_:1}),o(i,{label:"\u6587\u6863\u7C7B\u578B",required:"",name:"docType"},{default:e(()=>[o(y,{value:t.docEdit.docType,"onUpdate:value":a[4]||(a[4]=r=>t.docEdit.docType=r)},{default:e(()=>[o(l,{value:1},{default:e(()=>[We]),_:1}),o(l,{value:2},{default:e(()=>[He]),_:1}),o(l,{value:3},{default:e(()=>[Xe]),_:1}),o(l,{value:4},{default:e(()=>[Ye]),_:1}),o(l,{value:5,disabled:""},{default:e(()=>[Ze]),_:1})]),_:1},8,["value"])]),_:1}),t.docEdit.docType===1?(c(),v(i,{key:0,label:"\u6587\u6863\u5730\u5740",required:"",name:"docUrl"},{extra:e(()=>[Ge,o(V,{title:"\u6587\u6863\u5730\u5740\u652F\u6301\u4EE5\u4E0B\u4EFB\u4E00\u683C\u5F0F"},{content:e(()=>[Ke,Qe,$e]),default:e(()=>[et]),_:1})]),default:e(()=>[o(S,{placeholder:"\u8BF7\u8F93\u5165\u6587\u6863\u5730\u5740URL",value:t.docEdit.docUrl,"onUpdate:value":a[5]||(a[5]=r=>t.docEdit.docUrl=r)},null,8,["value"])]),_:1})):t.docEdit.docType===2?(c(),v(i,{key:1,label:"\u6587\u6863\u5185\u5BB9",required:"",name:"jsonContent"},{extra:e(()=>[tt,o(V,{title:"\u6587\u6863\u5185\u5BB9\u8BF4\u660E"},{content:e(()=>[ot,$(g("div",null,[g("pre",null,[g("code",at,ee(t.swaggerDocDemo),1)])],512),[[W]])]),default:e(()=>[nt]),_:1})]),default:e(()=>[o(B,{value:t.docEdit.jsonContent,"onUpdate:value":a[6]||(a[6]=r=>t.docEdit.jsonContent=r),lang:"json",theme:"monokai",width:"100%",height:"100",options:t.aceEditorConfig},null,8,["value","options"])]),_:1})):I("",!0),t.docEdit.docType===3?(c(),v(i,{key:2,label:"\u6587\u6863\u5730\u5740",required:"",name:"docUrl"},{extra:e(()=>[lt,o(V,{title:"\u6587\u6863\u5730\u5740\u652F\u6301\u4EE5\u4E0B\u4EFB\u4E00\u683C\u5F0F"},{content:e(()=>[dt]),default:e(()=>[it]),_:1})]),default:e(()=>[o(S,{placeholder:"\u8BF7\u8F93\u5165\u6587\u6863\u5730\u5740URL",value:t.docEdit.docUrl,"onUpdate:value":a[7]||(a[7]=r=>t.docEdit.docUrl=r)},null,8,["value"])]),_:1})):t.docEdit.docType===4?(c(),v(i,{key:3,label:"\u6587\u6863\u5185\u5BB9",required:"",name:"jsonContent"},{extra:e(()=>[st,o(V,{title:"\u6587\u6863\u5185\u5BB9\u8BF4\u660E"},{content:e(()=>[rt,$(g("div",null,[g("pre",null,[g("code",ct,ee(t.openApiDocDemo),1)])],512),[[W]])]),default:e(()=>[ut]),_:1})]),default:e(()=>[o(B,{value:t.docEdit.jsonContent,"onUpdate:value":a[8]||(a[8]=r=>t.docEdit.jsonContent=r),lang:"json",theme:"monokai",width:"100%",height:"100",options:t.aceEditorConfig},null,8,["value","options"])]),_:1})):I("",!0),o(i,{label:"\u76EE\u6807\u57DF\u540D",name:"rewriteDomain"},{extra:e(()=>[_t,o(V,{title:"\u76EE\u6807\u57DF\u540D\u8BF4\u660E"},{content:e(()=>[mt,ht]),default:e(()=>[pt]),_:1})]),default:e(()=>[o(S,{placeholder:"\u8BF7\u8F93\u5165\u76EE\u6807\u57DF\u540D",value:t.docEdit.rewriteDomain,"onUpdate:value":a[9]||(a[9]=r=>t.docEdit.rewriteDomain=r)},null,8,["value"])]),_:1}),o(i,{label:"\u5F00\u653E\u8BBF\u95EE",required:"",name:"openVisit"},{extra:e(()=>[vt,g("a",{onClick:a[11]||(a[11]=r=>t.openShareViewWindow(t.docEdit))},"\u5F00\u653E\u6587\u6863URL"),yt]),default:e(()=>[o(y,{value:t.docEdit.openVisit,"onUpdate:value":a[10]||(a[10]=r=>t.docEdit.openVisit=r)},{default:e(()=>[o(l,{value:0},{default:e(()=>[ft]),_:1}),o(l,{value:1},{default:e(()=>[gt]),_:1})]),_:1},8,["value"])]),_:1}),o(i,{label:"\u72B6\u6001",required:"",name:"docStatus"},{default:e(()=>[o(y,{value:t.docEdit.docStatus,"onUpdate:value":a[12]||(a[12]=r=>t.docEdit.docStatus=r)},{default:e(()=>[o(l,{value:1},{default:e(()=>[bt]),_:1}),o(l,{value:2},{default:e(()=>[wt]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["visible","title","onOk"]),o(ae,{ref:"instruction"},null,512)],64)}var Dt=F(be,[["render",kt]]);const St={emits:["showDocList"],components:{DownOutlined:G,LinkOutlined:K,EditOutlined:Q},props:{doc:{type:Object,required:!0}},setup(u,{emit:a}){P();let _=f([]),t=f(!1),b=f({docId:"",pageNum:1,pageSize:20}),k=f({pageSize:20,pageNum:1,total:0,showSizeChanger:!0,pageSizeOptions:["20","50","100"],showTotal:s=>`\u5171${s}\u6761`});const m=(s,S,l)=>{k.value.pageNum=s.current,k.value.pageSize=s.pageSize,b.value.pageNum=s.current,b.value.pageSize=s.pageSize,p()},p=async()=>{t.value=!0,b.value.docId=u.doc.id,x.docAuthList(b.value).then(s=>{setTimeout(()=>t.value=!1,500),_.value=s.data||[],k.value.total=s.total||0})};let i=f({}),h=f({data:[],search:"",fetching:!1}),w=f([]),C=f(),U=f(!1);const E=s=>{h.value.search=s,!h.value.fetching&&(h.value.fetching=!0,w.value=[],setTimeout(()=>{x.searchUserList({search:h.value.search}).then(S=>{(S.data||[]).forEach(y=>w.value.push({label:y.userName,value:y.id})),h.value.fetching=!1})},500))},T=async()=>{C.value.validate().then(()=>{x.docAuthAssign(i.value).then(s=>{p(),U.value=!1})}).catch(s=>{console.log("error",s)})},A=async s=>{let S=Z(Y({},s),{docId:u.doc.id});x.docAuthAssign(S).then(l=>{q.success("\u4FEE\u6539\u6210\u529F")})},M=async()=>{U.value=!0,i.value={docId:u.doc.id,userId:void 0,authType:1}},O=async s=>{x.docAuthDelete({docId:u.doc.id,userId:s.userId}).then(S=>{p()})},D=()=>{a("showDocList")};return J(()=>{p()}),{showDocList:D,searchParam:b,docMemberList:_,docMemberListLoading:t,addUserVisible:U,userAdd:i,userSearchList:w,addUserFormRef:C,userSearchState:h,handleUserSearch:E,searchDocMemberList:p,openAddDocMember:M,handleAddUserOk:T,userAuthTypeChange:A,deleteDocMember:O,handleTableChange:m,pagination:k,docListColumns:[{title:"ID",dataIndex:"userId",width:70},{title:"\u7528\u6237\u540D",dataIndex:"userName"},{title:"\u5E10\u53F7",dataIndex:"userNo"},{title:"\u90AE\u7BB1",dataIndex:"email"},{title:"\u624B\u673A\u53F7",dataIndex:"phone"},{title:"\u6027\u522B",dataIndex:"sex",width:90},{title:"\u89D2\u8272",dataIndex:"authType",width:200},{title:"\u64CD\u4F5C",dataIndex:"operation",fixed:"right",width:100}],addUserRules:{userId:[{type:"number",required:!0,message:"\u8BF7\u9009\u62E9\u7528\u6237",trigger:"change"}],authType:[{type:"number",required:!0,message:"\u8BF7\u9009\u62E9\u7528\u6237\u89D2\u8272",trigger:"change"}]}}}},It=n("\u67E5\u8BE2"),Ct=n("\u6DFB\u52A0\u7528\u6237"),xt=n("\u5220\u9664"),Ut=n("\u7537"),Lt=n("\u5973"),Et=n("-"),Tt=n("\u7BA1\u7406\u5458"),At=n("\u5F00\u53D1\u4EBA\u5458"),Vt=n("\u7BA1\u7406\u5458"),zt=n("\u5F00\u53D1\u4EBA\u5458");function Mt(u,a,_,t,b,k){const m=d("a-button"),p=d("a-page-header"),i=d("a-popconfirm"),h=d("a-tag"),w=d("a-select-option"),C=d("a-select"),U=d("a-table"),E=d("a-spin"),T=d("a-form-item"),A=d("a-radio"),M=d("a-radio-group"),O=d("a-form"),D=d("a-modal");return c(),L(z,null,[o(p,{title:"\u6210\u5458\u7BA1\u7406","sub-title":_.doc.name||"",onBack:t.showDocList},{extra:e(()=>[o(m,{onClick:t.searchDocMemberList,type:"primary"},{default:e(()=>[It]),_:1},8,["onClick"]),o(m,{onClick:t.openAddDocMember,style:{marginLeft:"8px"}},{default:e(()=>[Ct]),_:1},8,["onClick"])]),_:1},8,["sub-title","onBack"]),o(U,{dataSource:t.docMemberList,columns:t.docListColumns,size:"middle",loading:t.docMemberListLoading,pagination:!1,onChange:t.handleTableChange,scroll:{x:1400,y:"calc(100vh - 300px)"}},{bodyCell:e(({column:s,text:S,record:l})=>[s.dataIndex==="operation"?(c(),v(i,{key:0,title:"\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",onConfirm:y=>t.deleteDocMember(l)},{default:e(()=>[o(m,{size:"small",type:"link",danger:""},{default:e(()=>[xt]),_:1})]),_:2},1032,["onConfirm"])):I("",!0),s.dataIndex==="sex"?(c(),L(z,{key:1},[l.sex===1?(c(),v(h,{key:0,color:"pink"},{default:e(()=>[Ut]),_:1})):l.sex===0?(c(),v(h,{key:1,color:"red"},{default:e(()=>[Lt]),_:1})):(c(),v(h,{key:2,color:"orange"},{default:e(()=>[Et]),_:1}))],64)):I("",!0),s.dataIndex==="authType"?(c(),v(C,{key:2,placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272",value:l.authType,"onUpdate:value":y=>l.authType=y,onChange:y=>t.userAuthTypeChange(l),style:{width:"150px"}},{default:e(()=>[o(w,{value:1},{default:e(()=>[Tt]),_:1}),o(w,{value:2},{default:e(()=>[At]),_:1})]),_:2},1032,["value","onUpdate:value","onChange"])):I("",!0)]),_:1},8,["dataSource","columns","loading","onChange","scroll"]),o(D,{visible:t.addUserVisible,"onUpdate:visible":a[2]||(a[2]=s=>t.addUserVisible=s),title:"\u6DFB\u52A0\u7528\u6237",onOk:t.handleAddUserOk,width:600},{default:e(()=>[o(O,{layout:"horizontal",ref:"addUserFormRef",model:t.userAdd,rules:t.addUserRules,"label-col":{span:4},"wrapper-col":{span:20}},{default:e(()=>[o(T,{label:"\u9009\u62E9\u7528\u6237",required:"",name:"userId"},{default:e(()=>[o(C,{value:t.userAdd.userId,"onUpdate:value":a[0]||(a[0]=s=>t.userAdd.userId=s),"show-search":"",placeholder:"\u8F93\u5165\u7528\u6237\u540D\u3001\u90AE\u7BB1\u3001\u624B\u673A\u53F7\u641C\u7D22","default-active-first-option":!1,"show-arrow":!0,"filter-option":!1,"not-found-content":void 0,options:t.userSearchList,onSearch:t.handleUserSearch},me({_:2},[t.userSearchState.fetching?{name:"notFoundContent",fn:e(()=>[o(E,{size:"small"})])}:void 0]),1032,["value","options","onSearch"])]),_:1}),o(T,{label:"\u7528\u6237\u89D2\u8272",required:"",name:"authType"},{default:e(()=>[o(M,{value:t.userAdd.authType,"onUpdate:value":a[1]||(a[1]=s=>t.userAdd.authType=s)},{default:e(()=>[o(A,{value:1},{default:e(()=>[Vt]),_:1}),o(A,{value:2},{default:e(()=>[zt]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","onOk"])],64)}var Ot=F(St,[["render",Mt]]);const Nt={components:{DocManageList:Dt,DocManageMembers:Ot},setup(){let u=f("list"),a=f({});return{showView:u,docInfo:a,showMembers:b=>{a.value=b,u.value="members"},showDocList:()=>{u.value="list"}}}},qt={key:1};function jt(u,a,_,t,b,k){const m=d("DocManageList"),p=d("DocManageMembers");return t.showView==="list"?(c(),v(m,{key:0,onShowMembers:t.showMembers},null,8,["onShowMembers"])):(c(),L("div",qt,[t.showView==="members"?(c(),v(p,{key:0,onShowDocList:t.showDocList,doc:t.docInfo},null,8,["onShowDocList","doc"])):I("",!0)]))}var Ht=F(Nt,[["render",jt]]);export{Ht as default};
