var de=Object.defineProperty,ie=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var G=(r,a,m)=>a in r?de(r,a,{enumerable:!0,configurable:!0,writable:!0,value:m}):r[a]=m,K=(r,a)=>{for(var m in a||(a={}))se.call(a,m)&&G(r,m,a[m]);if(J)for(var m of J(a))ce.call(a,m)&&G(r,m,a[m]);return r},W=(r,a)=>ie(r,le(a));import{z as L,g as H}from"./custom.75470d4e.js";import{_ as re,I as ue,u as R,y as g,N as Q,O as j,r as d,o as c,c as p,B as O,D as Z,$ as X,H as Y,a0 as _e,w as t,a as o,Q as $,e as D,t as ee,k,m as i,a1 as te,P as oe,b as A,F as N,a2 as me,a3 as he,a4 as pe,a5 as fe}from"./vendor.af29ba15.js";import{a as F}from"./index.00076c23.js";import{m as ge}from"./index.1abd215d.js";import{_ as M}from"./main.8a6f02ce.js";import{E as ve}from"./EditGlobalParam.622c2bb5.js";const ye={components:{aceEditor:F,BranchesOutlined:re,mavonEditor:ge.exports.mavonEditor,InfoCircleOutlined:ue},props:{doc:{type:Object,required:!0}},setup(r,{emit:a}){R();let m=g({}),e=g("");Q(()=>r.doc,()=>{y()});const v=()=>e.value?{id:m.value.id,shareInstruction:e.value}:(O.error("\u8BF7\u8F93\u5165\u5F00\u653E\u6587\u6863\u7684\u8BF4\u660E"),!1),y=async()=>{m.value=r.doc,e.value=r.doc.shareInstruction},s=(u,_)=>{},l=(u,_)=>(O.error("\u6682\u4E0D\u652F\u6301\u56FE\u7247\u4E0A\u4F20"),!1);return j(()=>{y()}),{docEdit:m,shareInstruction:e,getDoc:v,editDoc:y,imageFilter:l,addMarkdownImage:s,toolbars:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!1,code:!0,table:!0,fullscreen:!0,readmodel:!0,undo:!0,redo:!0,trash:!0,save:!0,navigation:!1,alignleft:!0,aligncenter:!0,alignright:!0,subfield:!0,preview:!0}}}};function be(r,a,m,e,v,y){const s=d("mavon-editor");return c(),p(s,{ref:"mavonEditor",modelValue:e.shareInstruction,"onUpdate:modelValue":a[0]||(a[0]=l=>e.shareInstruction=l),toolbars:e.toolbars,externalLink:!1,onImgAdd:e.addMarkdownImage,imageFilter:e.imageFilter,style:{height:"100%"},placeholder:"\u8BF7\u5F55\u5165\u5F00\u653E\u6587\u6863\u8BF4\u660E"},null,8,["modelValue","toolbars","onImgAdd","imageFilter"])}var ae=M(ye,[["render",be]]);const we={emits:["edit"],components:{aceEditor:F,EditShareInstruction:ae,DownOutlined:Z,LinkOutlined:X,EditOutlined:Y},props:{doc:{type:Object,required:!0}},setup(r,{emit:a}){const m=R();let e=g({}),v=g();Q(()=>r.doc,()=>{s()});const y=async()=>{v.value.validate().then(()=>{L.apiDocAdd(e.value).then(_=>{m.commit("addDocChangedNum")})}).catch(_=>{console.log("error",_)})},s=()=>{e.value=r.doc},l=async()=>(await v.value.validate(),e.value),u=_=>{_.shareUuid?_.openVisit!==1?O.warning("\u8BE5\u6587\u6863\u5C1A\u672A\u5F00\u542F\u5F00\u653E\u8BBF\u95EE\u529F\u80FD\uFF0C\u8BF7\u5728\u7F16\u8F91\u9875\u9009\u62E9\u5F00\u653E\u540E\u518D\u8BD5"):window.open(H()+"/doc-api#/share/home?uuid="+_.shareUuid):O.warning("\u8BF7\u5148\u4FDD\u5B58\u6587\u6863\u540E\u518D\u8BD5")};return j(()=>{s()}),{docEdit:e,newDocFormRef:v,handleNewDocOk:y,editDoc:s,getDoc:l,openShareViewWindow:u,newDocRules:{name:[{required:!0,message:"\u8BF7\u8F93\u5165\u6587\u6863\u540D\u79F0",trigger:"change"}],docUrl:[{required:!0,message:"\u8BF7\u8F93\u5165\u6587\u6863\u5730\u5740",trigger:"change"}],jsonContent:[{required:!0,message:"\u8BF7\u8F93\u5165JSON\u683C\u5F0F\u7684swagger\u6587\u6863\u5185\u5BB9",trigger:"change"}],docType:[{type:"number",required:!0,message:"\u8BF7\u9009\u62E9\u6587\u6863\u7C7B\u578B",trigger:"change"}],openVisit:[{type:"number",required:!0,message:"\u8BF7\u9009\u62E9\u662F\u5426\u5F00\u653E\u8BBF\u95EE",trigger:"change"}],docStatus:[{type:"number",required:!0,message:"\u8BF7\u9009\u62E9\u6587\u6863\u72B6\u6001",trigger:"change"}]},aceEditorConfig:{wrap:!0,autoScrollEditorIntoView:!0,enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0,minLines:10,maxLines:15},swaggerDocDemo:`{
    "swagger": "2.0",
    "info": {},
    "host": "doc.zyplayer.com",
    "basePath":"/",
    "tags": [],
    "paths": {},
    "definitions": {}
}`,openApiDocDemo:`{
    "openapi": "3.0.3",
    "components": {}
    "servers": [],
    "paths": {},
    "info": {},
}`}}},De=i("Swagger URL"),ke=i("Swagger JSON"),Ee=i("OpenApi URL"),Ie=i("OpenApi JSON"),Se=i("\u81EA\u5EFAAPI"),xe=i(" \u67E5\u770B\u6587\u6863\u5730\u5740 "),Ce=D("p",null,"\u683C\u5F0F\u4E00\uFF1Ahttp://doc.zyplayer.com/v2/api-docs",-1),Le=D("p",null,"\u683C\u5F0F\u4E8C\uFF1Ahttp://doc.zyplayer.com/swagger-resources",-1),Ue=D("p",null,"\u683C\u5F0F\u4E09\uFF1Ahttp://doc.zyplayer.com/swagger-ui.html",-1),Te=D("a",null,"\u793A\u4F8B",-1),Oe=i(" \u67E5\u770B\u6587\u6863\u5185\u5BB9 "),Ae=D("div",null,'\u652F\u6301\u4EE5\u4E0B\u683C\u5F0F\u7684Swagger\u6587\u6863\u5185\u5BB9\u8F93\u5165\uFF0C\u5176\u4E2D {"swagger": "2.0"} \u4E3A\u5FC5\u8981\u5C5E\u6027',-1),Ve={class:"lang-json"},ze=D("a",null,"\u8BF4\u660E",-1),Ne=i(" \u67E5\u770B\u6587\u6863\u5730\u5740 "),qe=D("p",null,"\u683C\u5F0F\u4E00\uFF1Ahttp://doc.zyplayer.com/v3/api-docs",-1),Me=D("a",null,"\u793A\u4F8B",-1),Re=i(" \u67E5\u770B\u6587\u6863\u5185\u5BB9 "),je=D("div",null,'\u652F\u6301\u4EE5\u4E0B\u683C\u5F0F\u7684OpenApi\u6587\u6863\u5185\u5BB9\u8F93\u5165\uFF0C\u5176\u4E2D {"openapi": "3.x.x"} \u4E3A\u5FC5\u8981\u5C5E\u6027',-1),Be={class:"lang-json"},Pe=D("a",null,"\u8BF4\u660E",-1),Fe=i(" \u76EE\u6807\u57DF\u540D "),Je=D("p",null,"\u5728\u6587\u6863\u7684\u5728\u7EBF\u8C03\u8BD5\u754C\u9762\uFF0C\u8BBF\u95EE\u7684\u57DF\u540D\u53EF\u4EE5\u521D\u59CB\u4E3A\u6B64\u5904\u5F55\u5165\u7684\u57DF\u540D\uFF0C\u800C\u975E\u6587\u6863\u672C\u8EAB\u7684\u57DF\u540D\u5730\u5740",-1),Ge=D("p",null,"\u53EF\u4FBF\u4E8E\u4E0D\u540C\u73AF\u5883\u95F4\u7684\u63A5\u53E3\u6D4B\u8BD5\uFF0C\u4F8B\uFF1Ahttp://doc.zyplayer.com",-1),Ke=D("a",null,"\u8BF4\u660E",-1),We=i("\u5426"),He=i("\u5F00\u653E\u8BBF\u95EE"),Qe=i(" \u5F00\u653E\u8BBF\u95EE\u540E\u65E0\u9700\u767B\u5F55\u5373\u53EF\u901A\u8FC7"),Ze=i("\u8BBF\u95EE\u8BE5\u6587\u6863\u4FE1\u606F "),Xe=i("\u542F\u7528"),Ye=i("\u7981\u7528");function $e(r,a,m,e,v,y){const s=d("a-input"),l=d("a-form-item"),u=d("a-radio"),_=d("a-tooltip"),b=d("a-radio-group"),f=d("a-popover"),E=d("ace-editor"),x=d("a-form"),S=_e("highlight");return c(),p(x,{layout:"horizontal",ref:"newDocFormRef",rules:e.newDocRules,model:e.docEdit,"label-col":{span:4},"wrapper-col":{span:18}},{default:t(()=>[o(l,{label:"\u6587\u6863\u540D\u79F0",required:"",name:"name"},{default:t(()=>[o(s,{placeholder:"\u8BF7\u8F93\u5165\u6587\u6863\u540D\u79F0",value:e.docEdit.name,"onUpdate:value":a[0]||(a[0]=h=>e.docEdit.name=h)},null,8,["value"])]),_:1}),o(l,{label:"\u6587\u6863\u7C7B\u578B",required:"",name:"docType"},{default:t(()=>[o(b,{value:e.docEdit.docType,"onUpdate:value":a[1]||(a[1]=h=>e.docEdit.docType=h)},{default:t(()=>[o(u,{value:1},{default:t(()=>[De]),_:1}),o(u,{value:2},{default:t(()=>[ke]),_:1}),o(u,{value:3},{default:t(()=>[Ee]),_:1}),o(u,{value:4},{default:t(()=>[Ie]),_:1}),o(_,{title:"\u5373\u5C06\u4E0A\u7EBF\uFF0C\u656C\u8BF7\u671F\u5F85"},{default:t(()=>[o(u,{value:5,disabled:""},{default:t(()=>[Se]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),e.docEdit.docType===1?(c(),p(l,{key:0,label:"\u6587\u6863\u5730\u5740",required:"",name:"docUrl"},{extra:t(()=>[xe,o(f,{title:"\u6587\u6863\u5730\u5740\u652F\u6301\u4EE5\u4E0B\u4EFB\u4E00\u683C\u5F0F"},{content:t(()=>[Ce,Le,Ue]),default:t(()=>[Te]),_:1})]),default:t(()=>[o(s,{placeholder:"\u8BF7\u8F93\u5165\u6587\u6863\u5730\u5740URL",value:e.docEdit.docUrl,"onUpdate:value":a[2]||(a[2]=h=>e.docEdit.docUrl=h)},null,8,["value"])]),_:1})):e.docEdit.docType===2?(c(),p(l,{key:1,label:"\u6587\u6863\u5185\u5BB9",required:"",name:"jsonContent"},{extra:t(()=>[Oe,o(f,{title:"\u6587\u6863\u5185\u5BB9\u8BF4\u660E"},{content:t(()=>[Ae,$(D("div",null,[D("pre",null,[D("code",Ve,ee(e.swaggerDocDemo),1)])],512),[[S]])]),default:t(()=>[ze]),_:1})]),default:t(()=>[o(E,{value:e.docEdit.jsonContent,"onUpdate:value":a[3]||(a[3]=h=>e.docEdit.jsonContent=h),lang:"json",theme:"monokai",width:"100%",height:"100",options:e.aceEditorConfig},null,8,["value","options"])]),_:1})):k("",!0),e.docEdit.docType===3?(c(),p(l,{key:2,label:"\u6587\u6863\u5730\u5740",required:"",name:"docUrl"},{extra:t(()=>[Ne,o(f,{title:"\u6587\u6863\u5730\u5740\u652F\u6301\u4EE5\u4E0B\u4EFB\u4E00\u683C\u5F0F"},{content:t(()=>[qe]),default:t(()=>[Me]),_:1})]),default:t(()=>[o(s,{placeholder:"\u8BF7\u8F93\u5165\u6587\u6863\u5730\u5740URL",value:e.docEdit.docUrl,"onUpdate:value":a[4]||(a[4]=h=>e.docEdit.docUrl=h)},null,8,["value"])]),_:1})):e.docEdit.docType===4?(c(),p(l,{key:3,label:"\u6587\u6863\u5185\u5BB9",required:"",name:"jsonContent"},{extra:t(()=>[Re,o(f,{title:"\u6587\u6863\u5185\u5BB9\u8BF4\u660E"},{content:t(()=>[je,$(D("div",null,[D("pre",null,[D("code",Be,ee(e.openApiDocDemo),1)])],512),[[S]])]),default:t(()=>[Pe]),_:1})]),default:t(()=>[o(E,{value:e.docEdit.jsonContent,"onUpdate:value":a[5]||(a[5]=h=>e.docEdit.jsonContent=h),lang:"json",theme:"monokai",width:"100%",height:"100",options:e.aceEditorConfig},null,8,["value","options"])]),_:1})):k("",!0),o(l,{label:"\u76EE\u6807\u57DF\u540D",name:"rewriteDomain"},{extra:t(()=>[Fe,o(f,{title:"\u76EE\u6807\u57DF\u540D\u8BF4\u660E"},{content:t(()=>[Je,Ge]),default:t(()=>[Ke]),_:1})]),default:t(()=>[o(s,{placeholder:"\u8BF7\u8F93\u5165\u76EE\u6807\u57DF\u540D",value:e.docEdit.rewriteDomain,"onUpdate:value":a[6]||(a[6]=h=>e.docEdit.rewriteDomain=h)},null,8,["value"])]),_:1}),o(l,{label:"\u5F00\u653E\u8BBF\u95EE",required:"",name:"openVisit"},{extra:t(()=>[Qe,D("a",{onClick:a[8]||(a[8]=h=>e.openShareViewWindow(e.docEdit))},"\u5F00\u653E\u6587\u6863URL"),Ze]),default:t(()=>[o(b,{value:e.docEdit.openVisit,"onUpdate:value":a[7]||(a[7]=h=>e.docEdit.openVisit=h)},{default:t(()=>[o(u,{value:0},{default:t(()=>[We]),_:1}),o(u,{value:1},{default:t(()=>[He]),_:1})]),_:1},8,["value"])]),_:1}),o(l,{label:"\u72B6\u6001",required:"",name:"docStatus"},{default:t(()=>[o(b,{value:e.docEdit.docStatus,"onUpdate:value":a[9]||(a[9]=h=>e.docEdit.docStatus=h)},{default:t(()=>[o(u,{value:1},{default:t(()=>[Xe]),_:1}),o(u,{value:2},{default:t(()=>[Ye]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["rules","model"])}var ne=M(we,[["render",$e]]);const et={emits:["edit"],components:{aceEditor:F,DownOutlined:Z,LinkOutlined:X,EditOutlined:Y,SearchOutlined:te,PlusOutlined:oe,EditDocBaseInfo:ne},setup(r,{emit:a}){const m=R();let e=g([]),v=g(!1),y=g({docType:"",openVisit:"",docStatus:"",pageNum:1,pageSize:20}),s=g({pageSize:20,pageNum:1,total:0,showSizeChanger:!0,pageSizeOptions:["20","50","100"],showTotal:n=>`\u5171${n}\u6761`});const l=(n,w,z)=>{s.value.pageNum=n.current,s.value.pageSize=n.pageSize,y.value.pageNum=n.current,y.value.pageSize=n.pageSize,u()},u=async()=>{v.value=!0,L.apiDocList(y.value).then(n=>{setTimeout(()=>v.value=!1,500),e.value=n.data||[],s.value.total=n.total||0})};let _=g({}),b=g(),f=g(!1);const E=async()=>{let n=await b.value.getDoc();L.apiDocAdd(n).then(w=>{f.value=!1,m.commit("addDocChangedNum"),u()})},x=async()=>{f.value=!0,_.value={docType:1,openVisit:0,docStatus:1,isNew:1}},S=n=>{a("edit","edit",n)},h=(n,w,z)=>{L.apiDocUpdate({id:n,docStatus:w,yn:z}).then(C=>{m.commit("addDocChangedNum"),u()})},U=n=>{me.confirm({title:"\u518D\u6B21\u786E\u8BA4",icon:o(he),content:"\u4F60\u771F\u7684\u786E\u5B9A\u8981\u5220\u9664\u6B64\u6587\u6863\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk(){h(n.id,null,0)}})},V=n=>{n.shareUuid?n.openVisit!==1?O.warning("\u8BE5\u6587\u6863\u5C1A\u672A\u5F00\u542F\u5F00\u653E\u8BBF\u95EE\u529F\u80FD\uFF0C\u8BF7\u5728\u7F16\u8F91\u9875\u9009\u62E9\u5F00\u653E\u540E\u518D\u8BD5"):window.open(H()+"/doc-api#/share/home?uuid="+n.shareUuid):O.warning("\u8BF7\u5148\u4FDD\u5B58\u6587\u6863\u540E\u518D\u8BD5")},q=(n,w)=>{n.key==="shareView"&&V(w)};return j(()=>{u()}),{searchParam:y,docList:e,docListLoading:v,newDocVisible:f,docEdit:_,docBaseInfoRef:b,searchDocList:u,openNewDoc:x,handleNewDocOk:E,deleteDoc:U,editDoc:S,handleTableChange:l,openShareViewWindow:V,handleActionMenuClick:q,pagination:s,newDocRules:{name:[{required:!0,message:"\u8BF7\u8F93\u5165\u6587\u6863\u540D\u79F0",trigger:"change"}],docUrl:[{required:!0,message:"\u8BF7\u8F93\u5165\u6587\u6863\u5730\u5740",trigger:"change"}],jsonContent:[{required:!0,message:"\u8BF7\u8F93\u5165JSON\u683C\u5F0F\u7684swagger\u6587\u6863\u5185\u5BB9",trigger:"change"}],docType:[{type:"number",required:!0,message:"\u8BF7\u9009\u62E9\u6587\u6863\u7C7B\u578B",trigger:"change"}],openVisit:[{type:"number",required:!0,message:"\u8BF7\u9009\u62E9\u662F\u5426\u5F00\u653E\u8BBF\u95EE",trigger:"change"}],docStatus:[{type:"number",required:!0,message:"\u8BF7\u9009\u62E9\u6587\u6863\u72B6\u6001",trigger:"change"}]},docListColumns:[{title:"ID",dataIndex:"id",width:70},{title:"\u6587\u6863\u540D\u79F0",dataIndex:"name",width:250},{title:"\u6587\u6863\u7C7B\u578B",dataIndex:"docType",width:120},{title:"\u5F00\u653E\u8BBF\u95EE",dataIndex:"openVisit",width:90},{title:"\u72B6\u6001",dataIndex:"docStatus",width:90},{title:"\u6587\u6863\u5730\u5740",dataIndex:"docUrl"},{title:"\u76EE\u6807\u57DF\u540D",dataIndex:"rewriteDomain",width:250},{title:"\u64CD\u4F5C",dataIndex:"operation",fixed:"right",width:200}]}}},tt=i("\u5168\u90E8"),ot=i("URL\u6DFB\u52A0"),at=i("JSON\u5185\u5BB9"),nt=i("\u5168\u90E8"),dt=i("\u5426"),it=i("\u662F"),lt=i("\u5168\u90E8"),st=i("\u542F\u7528"),ct=i("\u7981\u7528"),rt=i(" \u67E5\u8BE2"),ut=i(" \u65B0\u5EFA"),_t=i("\u7F16\u8F91"),mt=i("\u5220\u9664"),ht=i(" \u67E5\u770B\u5F00\u653E\u6587\u6863"),pt=i("\u66F4\u591A"),ft=i("Swagger URL"),gt=i("Swagger JSON"),vt=i("Swagger URL"),yt=i("OpenApi JSON"),bt=i("\u81EA\u5EFAAPI"),wt=i("\u672A\u5F00\u653E"),Dt=i("\u5DF2\u5F00\u653E"),kt=i("\u542F\u7528"),Et=i("\u7981\u7528");function It(r,a,m,e,v,y){const s=d("a-select-option"),l=d("a-select"),u=d("a-form-item"),_=d("SearchOutlined"),b=d("a-button"),f=d("PlusOutlined"),E=d("a-form"),x=d("a-popconfirm"),S=d("link-outlined"),h=d("a-menu-item"),U=d("a-menu"),V=d("DownOutlined"),q=d("a-dropdown"),n=d("a-tag"),w=d("a-table"),z=d("EditDocBaseInfo"),C=d("a-modal");return c(),A(N,null,[o(E,{layout:"inline",style:{"margin-bottom":"20px"}},{default:t(()=>[o(u,{label:"\u6587\u6863\u7C7B\u578B"},{default:t(()=>[o(l,{placeholder:"\u8BF7\u9009\u62E9\u6587\u6863\u7C7B\u578B",value:e.searchParam.docType,"onUpdate:value":a[0]||(a[0]=I=>e.searchParam.docType=I),style:{width:"150px"}},{default:t(()=>[o(s,{value:""},{default:t(()=>[tt]),_:1}),o(s,{value:1},{default:t(()=>[ot]),_:1}),o(s,{value:2},{default:t(()=>[at]),_:1})]),_:1},8,["value"])]),_:1}),o(u,{label:"\u5F00\u653E\u8BBF\u95EE"},{default:t(()=>[o(l,{placeholder:"\u8BF7\u9009\u62E9\u5F00\u653E\u8BBF\u95EE",value:e.searchParam.openVisit,"onUpdate:value":a[1]||(a[1]=I=>e.searchParam.openVisit=I),style:{width:"150px"}},{default:t(()=>[o(s,{value:""},{default:t(()=>[nt]),_:1}),o(s,{value:0},{default:t(()=>[dt]),_:1}),o(s,{value:1},{default:t(()=>[it]),_:1})]),_:1},8,["value"])]),_:1}),o(u,{label:"\u72B6\u6001"},{default:t(()=>[o(l,{placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001",value:e.searchParam.docStatus,"onUpdate:value":a[2]||(a[2]=I=>e.searchParam.docStatus=I),style:{width:"150px"}},{default:t(()=>[o(s,{value:""},{default:t(()=>[lt]),_:1}),o(s,{value:1},{default:t(()=>[st]),_:1}),o(s,{value:2},{default:t(()=>[ct]),_:1})]),_:1},8,["value"])]),_:1}),o(u,null,{default:t(()=>[o(b,{onClick:e.searchDocList,type:"primary"},{icon:t(()=>[o(_)]),default:t(()=>[rt]),_:1},8,["onClick"]),o(b,{onClick:e.openNewDoc,style:{marginLeft:"8px"}},{icon:t(()=>[o(f)]),default:t(()=>[ut]),_:1},8,["onClick"])]),_:1})]),_:1}),o(w,{dataSource:e.docList,columns:e.docListColumns,size:"middle",loading:e.docListLoading,pagination:e.pagination,onChange:e.handleTableChange,scroll:{x:1400,y:"calc(100vh - 300px)"}},{bodyCell:t(({column:I,text:T,record:B})=>[I.dataIndex==="operation"?(c(),A(N,{key:0},[o(b,{size:"small",type:"link",onClick:P=>e.editDoc(B)},{default:t(()=>[_t]),_:2},1032,["onClick"]),B.authType===1?(c(),p(x,{key:0,title:"\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",onConfirm:P=>e.deleteDoc(B)},{default:t(()=>[o(b,{size:"small",type:"link",danger:""},{default:t(()=>[mt]),_:1})]),_:2},1032,["onConfirm"])):k("",!0),o(q,{trigger:["click"]},{overlay:t(()=>[o(U,{onClick:P=>e.handleActionMenuClick(P,B)},{default:t(()=>[o(h,{key:"shareView"},{default:t(()=>[o(S),ht]),_:1})]),_:2},1032,["onClick"])]),default:t(()=>[o(b,{type:"link",size:"small"},{default:t(()=>[pt,o(V)]),_:1})]),_:2},1024)],64)):k("",!0),I.dataIndex==="docType"?(c(),A(N,{key:1},[T===1?(c(),p(n,{key:0,color:"red"},{default:t(()=>[ft]),_:1})):T===2?(c(),p(n,{key:1,color:"blue"},{default:t(()=>[gt]),_:1})):T===3?(c(),p(n,{key:2,color:"blue"},{default:t(()=>[vt]),_:1})):T===4?(c(),p(n,{key:3,color:"green"},{default:t(()=>[yt]),_:1})):T===5?(c(),p(n,{key:4,color:"green"},{default:t(()=>[bt]),_:1})):k("",!0)],64)):k("",!0),I.dataIndex==="openVisit"?(c(),A(N,{key:2},[T===0?(c(),p(n,{key:0,color:"pink"},{default:t(()=>[wt]),_:1})):T===1?(c(),p(n,{key:1,color:"green"},{default:t(()=>[Dt]),_:1})):k("",!0)],64)):k("",!0),I.dataIndex==="docStatus"?(c(),A(N,{key:3},[T===1?(c(),p(n,{key:0,color:"green"},{default:t(()=>[kt]),_:1})):T===2?(c(),p(n,{key:1,color:"pink"},{default:t(()=>[Et]),_:1})):k("",!0)],64)):k("",!0)]),_:1},8,["dataSource","columns","loading","pagination","onChange","scroll"]),o(C,{visible:e.newDocVisible,"onUpdate:visible":a[3]||(a[3]=I=>e.newDocVisible=I),title:e.docEdit.isNew?"\u65B0\u589E\u6587\u6863":"\u7F16\u8F91\u6587\u6863",onOk:e.handleNewDocOk,width:850},{default:t(()=>[o(z,{ref:"docBaseInfoRef",doc:e.docEdit},null,8,["doc"])]),_:1},8,["visible","title","onOk"])],64)}var St=M(et,[["render",It]]);const xt={emits:["showDocList"],components:{PlusOutlined:oe,SearchOutlined:te},props:{doc:{type:Object,required:!0}},setup(r,{emit:a}){R();let m=g([]),e=g(!1),v=g({docId:"",pageNum:1,pageSize:20}),y=g({pageSize:20,pageNum:1,total:0,showSizeChanger:!0,pageSizeOptions:["20","50","100"],showTotal:n=>`\u5171${n}\u6761`});const s=(n,w,z)=>{y.value.pageNum=n.current,y.value.pageSize=n.pageSize,v.value.pageNum=n.current,v.value.pageSize=n.pageSize,l()},l=async()=>{!r.doc.id||(e.value=!0,v.value.docId=r.doc.id,L.docAuthList(v.value).then(n=>{setTimeout(()=>e.value=!1,500),m.value=n.data||[],y.value.total=n.total||0}).catch(()=>{e.value=!1}))};let u=g({}),_=g({data:[],search:"",fetching:!1}),b=g([]),f=g(),E=g(!1);const x=n=>{_.value.search=n,!_.value.fetching&&(_.value.fetching=!0,b.value=[],setTimeout(()=>{L.searchUserList({search:_.value.search}).then(w=>{(w.data||[]).forEach(C=>b.value.push({label:C.userName,value:C.id})),_.value.fetching=!1}).catch(()=>{_.value.fetching=!1})},500))},S=async()=>{f.value.validate().then(()=>{L.docAuthAssign(u.value).then(n=>{l(),E.value=!1})}).catch(n=>{console.log("error",n)})},h=async n=>{let w=W(K({},n),{docId:r.doc.id});L.docAuthAssign(w).then(z=>{O.success("\u4FEE\u6539\u6210\u529F")})},U=async()=>{E.value=!0,u.value={docId:r.doc.id,userId:void 0,authType:1}},V=async n=>{L.docAuthDelete({docId:r.doc.id,userId:n.userId}).then(w=>{l()})},q=()=>{a("showDocList")};return j(()=>{l()}),{showDocList:q,searchParam:v,docMemberList:m,docMemberListLoading:e,addUserVisible:E,userAdd:u,userSearchList:b,addUserFormRef:f,userSearchState:_,handleUserSearch:x,searchDocMemberList:l,openAddDocMember:U,handleAddUserOk:S,userAuthTypeChange:h,deleteDocMember:V,handleTableChange:s,pagination:y,docListColumns:[{title:"ID",dataIndex:"userId",width:70},{title:"\u7528\u6237\u540D",dataIndex:"userName"},{title:"\u5E10\u53F7",dataIndex:"userNo"},{title:"\u90AE\u7BB1",dataIndex:"email"},{title:"\u624B\u673A\u53F7",dataIndex:"phone"},{title:"\u6027\u522B",dataIndex:"sex",width:90},{title:"\u89D2\u8272",dataIndex:"authType",width:200},{title:"\u64CD\u4F5C",dataIndex:"operation",fixed:"right",width:100}],addUserRules:{userId:[{type:"number",required:!0,message:"\u8BF7\u9009\u62E9\u7528\u6237",trigger:"change"}],authType:[{type:"number",required:!0,message:"\u8BF7\u9009\u62E9\u7528\u6237\u89D2\u8272",trigger:"change"}]}}}},Ct={style:{"text-align":"right",margin:"0 10px 10px 0"}},Lt=i(" \u67E5\u8BE2 "),Ut=i(" \u6DFB\u52A0\u7528\u6237 "),Tt=i("\u5220\u9664"),Ot=i("\u7537"),At=i("\u5973"),Vt=i("-"),zt=i("\u7BA1\u7406\u5458"),Nt=i("\u5F00\u53D1\u4EBA\u5458"),qt=i("\u7BA1\u7406\u5458"),Mt=i("\u5F00\u53D1\u4EBA\u5458");function Rt(r,a,m,e,v,y){const s=d("search-outlined"),l=d("a-button"),u=d("plus-outlined"),_=d("a-popconfirm"),b=d("a-tag"),f=d("a-select-option"),E=d("a-select"),x=d("a-table"),S=d("a-spin"),h=d("a-form-item"),U=d("a-radio"),V=d("a-radio-group"),q=d("a-form"),n=d("a-modal");return c(),A(N,null,[D("div",Ct,[o(l,{onClick:e.searchDocMemberList,type:"primary"},{icon:t(()=>[o(s)]),default:t(()=>[Lt]),_:1},8,["onClick"]),o(l,{onClick:e.openAddDocMember,style:{marginLeft:"8px"}},{icon:t(()=>[o(u)]),default:t(()=>[Ut]),_:1},8,["onClick"])]),o(x,{dataSource:e.docMemberList,columns:e.docListColumns,size:"middle",loading:e.docMemberListLoading,pagination:!1,onChange:e.handleTableChange,scroll:{x:1e3,y:"calc(100vh - 300px)"}},{bodyCell:t(({column:w,text:z,record:C})=>[w.dataIndex==="operation"?(c(),p(_,{key:0,title:"\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",onConfirm:I=>e.deleteDocMember(C)},{default:t(()=>[o(l,{size:"small",type:"link",danger:""},{default:t(()=>[Tt]),_:1})]),_:2},1032,["onConfirm"])):k("",!0),w.dataIndex==="sex"?(c(),A(N,{key:1},[C.sex===1?(c(),p(b,{key:0,color:"pink"},{default:t(()=>[Ot]),_:1})):C.sex===0?(c(),p(b,{key:1,color:"red"},{default:t(()=>[At]),_:1})):(c(),p(b,{key:2,color:"orange"},{default:t(()=>[Vt]),_:1}))],64)):k("",!0),w.dataIndex==="authType"?(c(),p(E,{key:2,placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272",value:C.authType,"onUpdate:value":I=>C.authType=I,onChange:I=>e.userAuthTypeChange(C),style:{width:"150px"}},{default:t(()=>[o(f,{value:1},{default:t(()=>[zt]),_:1}),o(f,{value:2},{default:t(()=>[Nt]),_:1})]),_:2},1032,["value","onUpdate:value","onChange"])):k("",!0)]),_:1},8,["dataSource","columns","loading","onChange","scroll"]),o(n,{visible:e.addUserVisible,"onUpdate:visible":a[2]||(a[2]=w=>e.addUserVisible=w),title:"\u6DFB\u52A0\u7528\u6237",onOk:e.handleAddUserOk,width:600},{default:t(()=>[o(q,{layout:"horizontal",ref:"addUserFormRef",model:e.userAdd,rules:e.addUserRules,"label-col":{span:4},"wrapper-col":{span:20}},{default:t(()=>[o(h,{label:"\u9009\u62E9\u7528\u6237",required:"",name:"userId"},{default:t(()=>[o(E,{value:e.userAdd.userId,"onUpdate:value":a[0]||(a[0]=w=>e.userAdd.userId=w),"show-search":"",placeholder:"\u8F93\u5165\u7528\u6237\u540D\u3001\u90AE\u7BB1\u3001\u624B\u673A\u53F7\u641C\u7D22","default-active-first-option":!1,"show-arrow":!0,"filter-option":!1,"not-found-content":void 0,options:e.userSearchList,onSearch:e.handleUserSearch},pe({_:2},[e.userSearchState.fetching?{name:"notFoundContent",fn:t(()=>[o(S,{size:"small"})])}:void 0]),1032,["value","options","onSearch"])]),_:1}),o(h,{label:"\u7528\u6237\u89D2\u8272",required:"",name:"authType"},{default:t(()=>[o(V,{value:e.userAdd.authType,"onUpdate:value":a[1]||(a[1]=w=>e.userAdd.authType=w)},{default:t(()=>[o(U,{value:1},{default:t(()=>[qt]),_:1}),o(U,{value:2},{default:t(()=>[Mt]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","onOk"])],64)}var jt=M(xt,[["render",Rt]]);const Bt={emits:["showDocList"],components:{SaveOutlined:fe,EditShareInstruction:ae,EditDocBaseInfo:ne,DocManageMembers:jt,EditGlobalParam:ve},props:{doc:{type:Object,required:!0}},setup(r,{emit:a}){const m=R(),e=()=>{a("showDocList")};let v=g(),y=g(),s=g({}),l=g(!1);const u=async()=>{let f=await v.value.getDoc();l.value=!0,L.apiDocAdd(f).then(E=>{O.success("\u4FDD\u5B58\u6210\u529F\uFF01"),l.value=!1,m.commit("addDocChangedNum"),E.data.id!==f.id&&e()}).catch(()=>{l.value=!1})},_=()=>{let f=y.value.getDoc();!f||(l.value=!0,L.apiDocUpdate(f).then(E=>{O.success("\u4FDD\u5B58\u6210\u529F\uFF01"),l.value=!1}).catch(()=>{l.value=!1}))};let b=g("base");return j(()=>{s.value=r.doc,l.value=!0,L.apiDocDetail({id:r.doc.id}).then(f=>{l.value=!1,s.value=f.data}).catch(()=>{l.value=!1})}),{activeEditTab:b,showDocList:e,saveBaseInfo:u,saveShareInstruction:_,docBaseInfoRef:v,shareInstructionRef:y,docEdit:s,docEditLoading:l}}},Pt=i(" \u4FDD\u5B58\u57FA\u672C\u4FE1\u606F "),Ft=i(" \u4FDD\u5B58\u5F00\u653E\u6587\u6863\u8BF4\u660E ");function Jt(r,a,m,e,v,y){const s=d("a-page-header"),l=d("EditDocBaseInfo"),u=d("a-spin"),_=d("a-tab-pane"),b=d("DocManageMembers"),f=d("EditGlobalParam"),E=d("EditShareInstruction"),x=d("save-outlined"),S=d("a-button"),h=d("a-tabs");return c(),A(N,null,[o(s,{title:"\u7F16\u8F91","sub-title":e.docEdit.name||"",onBack:e.showDocList},{extra:t(()=>[]),_:1},8,["sub-title","onBack"]),o(h,{activeKey:e.activeEditTab,"onUpdate:activeKey":a[0]||(a[0]=U=>e.activeEditTab=U),style:{padding:"5px 10px 0"}},{rightExtra:t(()=>[e.activeEditTab==="base"&&e.docEdit.authType===1?(c(),p(S,{key:0,onClick:e.saveBaseInfo,loading:e.docEditLoading,type:"primary"},{icon:t(()=>[o(x)]),default:t(()=>[Pt]),_:1},8,["onClick","loading"])):k("",!0),e.activeEditTab==="instruction"?(c(),p(S,{key:1,onClick:e.saveShareInstruction,loading:e.docEditLoading,type:"primary"},{icon:t(()=>[o(x)]),default:t(()=>[Ft]),_:1},8,["onClick","loading"])):k("",!0)]),default:t(()=>[o(_,{tab:"\u57FA\u672C\u4FE1\u606F",key:"base",forceRender:""},{default:t(()=>[o(u,{tip:"\u6570\u636E\u52A0\u8F7D\u4E2D...",spinning:e.docEditLoading},{default:t(()=>[o(l,{ref:"docBaseInfoRef",doc:e.docEdit},null,8,["doc"])]),_:1},8,["spinning"])]),_:1}),e.docEdit.id>0&&e.docEdit.authType===1?(c(),p(_,{tab:"\u6210\u5458\u7BA1\u7406",key:"members"},{default:t(()=>[o(b,{doc:e.docEdit},null,8,["doc"])]),_:1})):k("",!0),e.docEdit.id>0?(c(),p(_,{tab:"\u6587\u6863\u5168\u5C40\u53C2\u6570",key:"globalParam"},{default:t(()=>[o(f,{"dynamic-param":{docId:e.docEdit.id}},null,8,["dynamic-param"])]),_:1})):k("",!0),e.docEdit.openVisit===1?(c(),p(_,{tab:"\u5F00\u653E\u6587\u6863\u8BF4\u660E",key:"instruction"},{default:t(()=>[o(E,{ref:"shareInstructionRef",doc:e.docEdit},null,8,["doc"])]),_:1})):k("",!0)]),_:1},8,["activeKey"])],64)}var Gt=M(Bt,[["render",Jt]]);const Kt={components:{DocManageList:St,DocManageEdit:Gt},setup(){let r=g("list"),a=g({});return{showView:r,docInfo:a,editDoc:(v,y)=>{a.value=y,r.value=v},showDocList:()=>{r.value="list"}}}},Wt={key:1};function Ht(r,a,m,e,v,y){const s=d("DocManageList"),l=d("DocManageEdit");return e.showView==="list"?(c(),p(s,{key:0,onEdit:e.editDoc},null,8,["onEdit"])):(c(),A("div",Wt,[e.showView==="edit"?(c(),p(l,{key:0,onShowDocList:e.showDocList,doc:e.docInfo},null,8,["onShowDocList","doc"])):k("",!0)]))}var oo=M(Kt,[["render",Ht]]);export{oo as default};
