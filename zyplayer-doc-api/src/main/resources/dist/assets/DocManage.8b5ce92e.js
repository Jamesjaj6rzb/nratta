import{z as E,g as Q}from"./custom.ece90331.js";import{T as Y,I as $,u as J,y as h,H as M,r as d,o as u,c as p,w as e,a as o,B as I,m as n,D as ee,V as te,W as oe,X as ae,b as x,F as V,k as y,J as W,e as s,t as H}from"./vendor.2a860d56.js";import{a as X}from"./index.7873781e.js";import{m as ne}from"./mavon-editor.824ddc3c.js";import{_ as Z}from"./main.4232e7c8.js";const le={components:{aceEditor:X,BranchesOutlined:Y,mavonEditor:ne.exports.mavonEditor,InfoCircleOutlined:$},setup(){J();let w=h({}),a=h(""),f=h(!1);const t=async()=>{if(!a.value){I.error("\u8BF7\u8F93\u5165\u5F00\u653E\u6587\u6863\u7684\u8BF4\u660E");return}E.apiDocUpdate({id:w.value.id,shareInstruction:a.value}).then(_=>{f.value=!1,I.success("\u4FDD\u5B58\u6210\u529F\uFF01")})},k=async _=>{f.value=!0,E.apiDocDetail({id:_}).then(r=>{w.value=r.data,a.value=r.data.shareInstruction})},C=(_,r)=>{},c=(_,r)=>(I.error("\u6682\u4E0D\u652F\u6301\u56FE\u7247\u4E0A\u4F20"),!1);return M(()=>{}),{editShareInstructionVisible:f,docEdit:w,shareInstruction:a,handleNewDocOk:t,editDoc:k,imageFilter:c,addMarkdownImage:C,toolbars:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!1,code:!0,table:!0,fullscreen:!0,readmodel:!0,undo:!0,redo:!0,trash:!0,save:!0,navigation:!0,alignleft:!0,aligncenter:!0,alignright:!0,subfield:!0,preview:!0}}}},ie=n(" \u7F16\u8F91\u5F00\u653E\u6587\u6863\u8BF4\u660E "),de=n("\u6B64\u8BF4\u660E\u6587\u6863\u5C06\u5C55\u793A\u5728\u5F00\u653E\u6587\u6863\u7684\u9996\u9875\u5C55\u793A\uFF0C\u53EF\u70B9\u51FB\u2018\u67E5\u770B\u5F00\u653E\u6587\u6863\u2019\u67E5\u770B\u6548\u679C");function re(w,a,f,t,k,C){const c=d("info-circle-outlined"),_=d("a-tooltip"),r=d("mavon-editor"),m=d("a-modal");return u(),p(m,{visible:t.editShareInstructionVisible,"onUpdate:visible":a[1]||(a[1]=b=>t.editShareInstructionVisible=b),onOk:t.handleNewDocOk,width:"90%",bodyStyle:{height:"calc(100vh - 300px)"}},{title:e(()=>[ie,o(_,{placement:"bottom"},{title:e(()=>[de]),default:e(()=>[o(c)]),_:1})]),default:e(()=>[o(r,{ref:"mavonEditor",modelValue:t.shareInstruction,"onUpdate:modelValue":a[0]||(a[0]=b=>t.shareInstruction=b),toolbars:t.toolbars,externalLink:!1,onImgAdd:t.addMarkdownImage,imageFilter:t.imageFilter,style:{height:"100%"},placeholder:"\u8BF7\u5F55\u5165\u5F00\u653E\u6587\u6863\u8BF4\u660E"},null,8,["modelValue","toolbars","onImgAdd","imageFilter"])]),_:1},8,["visible","onOk","bodyStyle"])}var se=Z(le,[["render",re]]);const ce={components:{aceEditor:X,EditShareInstruction:se,DownOutlined:ee,LinkOutlined:te,EditOutlined:oe},setup(){const w=J();let a=h([]),f=h(!1),t=h({docType:"",openVisit:"",docStatus:"",pageNum:1,pageSize:20}),k=h({pageSize:20,pageNum:1,total:0,showSizeChanger:!0,pageSizeOptions:["20","50","100"],showTotal:l=>`\u5171${l}\u6761`});const C=(l,v,D)=>{k.value.pageNum=l.current,k.value.pageSize=l.pageSize,t.value.pageNum=l.current,t.value.pageSize=l.pageSize,c()},c=async()=>{f.value=!0,E.apiDocList(t.value).then(l=>{setTimeout(()=>f.value=!1,500),a.value=l.data||[],k.value.total=l.total||0})};let _=h({}),r=h(),m=h(!1);const b=async()=>{r.value.validate().then(()=>{E.apiDocAdd(_.value).then(l=>{c(),m.value=!1,w.commit("addDocChangedNum")})}).catch(l=>{console.log("error",l)})},N=async()=>{m.value=!0,_.value={docType:1,openVisit:0,docStatus:1,isNew:1}},T=l=>{E.apiDocDetail({id:l.id}).then(v=>{_.value=v.data,m.value=!0})},O=async(l,v,D)=>{E.apiDocUpdate({id:l,docStatus:v,yn:D}).then(g=>{c(),w.commit("addDocChangedNum")})},j=async l=>O(l.id,null,0),L=l=>{l.shareUuid?l.openVisit!==1?I.warning("\u8BE5\u6587\u6863\u5C1A\u672A\u5F00\u542F\u5F00\u653E\u8BBF\u95EE\u529F\u80FD\uFF0C\u8BF7\u5728\u7F16\u8F91\u9875\u9009\u62E9\u5F00\u653E\u540E\u518D\u8BD5"):window.open(Q()+"/doc-api#/share/home?uuid="+l.shareUuid):I.warning("\u8BF7\u5148\u4FDD\u5B58\u6587\u6863\u540E\u518D\u8BD5")},A=(l,v)=>{l.key==="shareView"?L(v):l.key==="shareInstruction"&&z.value.editDoc(v.id)};let z=h();return M(()=>{c()}),{searchParam:t,docList:a,docListLoading:f,newDocVisible:m,docEdit:_,newDocFormRef:r,searchDocList:c,openNewDoc:N,handleNewDocOk:b,deleteDoc:j,editDoc:T,handleTableChange:C,openShareViewWindow:L,handleActionMenuClick:A,pagination:k,instruction:z,newDocRules:{name:[{required:!0,message:"\u8BF7\u8F93\u5165\u6587\u6863\u540D\u79F0",trigger:"change"}],docUrl:[{required:!0,message:"\u8BF7\u8F93\u5165\u6587\u6863\u5730\u5740",trigger:"change"}],jsonContent:[{required:!0,message:"\u8BF7\u8F93\u5165JSON\u683C\u5F0F\u7684swagger\u6587\u6863\u5185\u5BB9",trigger:"change"}],docType:[{type:"number",required:!0,message:"\u8BF7\u9009\u62E9\u6587\u6863\u7C7B\u578B",trigger:"change"}],openVisit:[{type:"number",required:!0,message:"\u8BF7\u9009\u62E9\u662F\u5426\u5F00\u653E\u8BBF\u95EE",trigger:"change"}],docStatus:[{type:"number",required:!0,message:"\u8BF7\u9009\u62E9\u6587\u6863\u72B6\u6001",trigger:"change"}]},docListColumns:[{title:"ID",dataIndex:"id",width:70},{title:"\u6587\u6863\u540D\u79F0",dataIndex:"name",width:250},{title:"\u6587\u6863\u7C7B\u578B",dataIndex:"docType",width:120},{title:"\u5F00\u653E\u8BBF\u95EE",dataIndex:"openVisit",width:90},{title:"\u72B6\u6001",dataIndex:"docStatus",width:90},{title:"\u6587\u6863\u5730\u5740",dataIndex:"docUrl"},{title:"\u76EE\u6807\u57DF\u540D",dataIndex:"rewriteDomain",width:250},{title:"\u64CD\u4F5C",dataIndex:"operation",fixed:"right",width:200}],aceEditorConfig:{wrap:!0,autoScrollEditorIntoView:!0,enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0,minLines:10,maxLines:15},swaggerDocDemo:`{
    "swagger": "2.0",
    "info": {},
    "host": "doc.zyplayer.com",
    "basePath":"/",
    "tags": [],
    "paths": {},
    "definitions": {}
}`,openApiDocDemo:`{
    "openapi": "3.0.3",
    "components": {}
    "servers": [],
    "paths": {},
    "info": {},
}`}}},ue=n("\u5168\u90E8"),_e=n("URL\u6DFB\u52A0"),me=n("JSON\u5185\u5BB9"),pe=n("\u5168\u90E8"),he=n("\u5426"),ge=n("\u662F"),fe=n("\u5168\u90E8"),ve=n("\u542F\u7528"),ye=n("\u7981\u7528"),we=n("\u67E5\u8BE2"),ke=n("\u65B0\u5EFA"),be=n("\u7F16\u8F91"),De=n("\u5220\u9664"),Se=n(" \u67E5\u770B\u5F00\u653E\u6587\u6863"),Ee=n(" \u7F16\u8F91\u5F00\u653E\u6587\u6863\u8BF4\u660E"),Ce=n("\u66F4\u591A"),Ue=n("Swagger URL"),Ie=n("Swagger JSON"),xe=n("OpenApi JSON"),Ve=n("\u672A\u5F00\u653E"),Oe=n("\u5DF2\u5F00\u653E"),Le=n("\u542F\u7528"),ze=n("\u7981\u7528"),Ne=n("Swagger URL"),Te=n("Swagger JSON"),je=n("OpenApi URL"),Ae=n("OpenApi JSON"),qe=n("\u81EA\u5EFAAPI"),Re=n(" \u67E5\u770B\u6587\u6863\u5730\u5740 "),Pe=s("p",null,"\u683C\u5F0F\u4E00\uFF1Ahttp://doc.zyplayer.com/v2/api-docs",-1),Be=s("p",null,"\u683C\u5F0F\u4E8C\uFF1Ahttp://doc.zyplayer.com/swagger-resources",-1),Fe=s("p",null,"\u683C\u5F0F\u4E09\uFF1Ahttp://doc.zyplayer.com/swagger-ui.html",-1),Je=s("a",null,"\u793A\u4F8B",-1),Me=n(" \u67E5\u770B\u6587\u6863\u5185\u5BB9 "),We=s("div",null,'\u652F\u6301\u4EE5\u4E0B\u683C\u5F0F\u7684Swagger\u6587\u6863\u5185\u5BB9\u8F93\u5165\uFF0C\u5176\u4E2D {"swagger": "2.0"} \u4E3A\u5FC5\u8981\u5C5E\u6027',-1),He={class:"lang-json"},Xe=s("a",null,"\u8BF4\u660E",-1),Ze=n(" \u67E5\u770B\u6587\u6863\u5730\u5740 "),Ge=s("p",null,"\u683C\u5F0F\u4E00\uFF1Ahttp://doc.zyplayer.com/v3/api-docs",-1),Ke=s("a",null,"\u793A\u4F8B",-1),Qe=n(" \u67E5\u770B\u6587\u6863\u5185\u5BB9 "),Ye=s("div",null,'\u652F\u6301\u4EE5\u4E0B\u683C\u5F0F\u7684OpenApi\u6587\u6863\u5185\u5BB9\u8F93\u5165\uFF0C\u5176\u4E2D {"openapi": "3.x.x"} \u4E3A\u5FC5\u8981\u5C5E\u6027',-1),$e={class:"lang-json"},et=s("a",null,"\u8BF4\u660E",-1),tt=n(" \u76EE\u6807\u57DF\u540D "),ot=s("p",null,"\u5728\u6587\u6863\u7684\u5728\u7EBF\u8C03\u8BD5\u754C\u9762\uFF0C\u8BBF\u95EE\u7684\u57DF\u540D\u53EF\u4EE5\u521D\u59CB\u4E3A\u6B64\u5904\u5F55\u5165\u7684\u57DF\u540D\uFF0C\u800C\u975E\u6587\u6863\u672C\u8EAB\u7684\u57DF\u540D\u5730\u5740",-1),at=s("p",null,"\u53EF\u4FBF\u4E8E\u4E0D\u540C\u73AF\u5883\u95F4\u7684\u63A5\u53E3\u6D4B\u8BD5\uFF0C\u4F8B\uFF1Ahttp://doc.zyplayer.com",-1),nt=s("a",null,"\u8BF4\u660E",-1),lt=n("\u5426"),it=n("\u5F00\u653E\u8BBF\u95EE"),dt=n(" \u5F00\u653E\u8BBF\u95EE\u540E\u65E0\u9700\u767B\u5F55\u5373\u53EF\u901A\u8FC7"),rt=n("\u8BBF\u95EE\u8BE5\u6587\u6863\u4FE1\u606F "),st=n("\u542F\u7528"),ct=n("\u7981\u7528");function ut(w,a,f,t,k,C){const c=d("a-select-option"),_=d("a-select"),r=d("a-form-item"),m=d("a-button"),b=d("a-form"),N=d("a-popconfirm"),T=d("link-outlined"),O=d("a-menu-item"),j=d("edit-outlined"),L=d("a-menu"),A=d("DownOutlined"),z=d("a-dropdown"),l=d("a-tag"),v=d("a-table"),D=d("a-input"),g=d("a-radio"),q=d("a-radio-group"),U=d("a-popover"),B=d("ace-editor"),G=d("a-modal"),K=d("EditShareInstruction"),F=ae("highlight");return u(),x(V,null,[o(b,{layout:"inline",style:{"margin-bottom":"20px"}},{default:e(()=>[o(r,{label:"\u6587\u6863\u7C7B\u578B"},{default:e(()=>[o(_,{placeholder:"\u8BF7\u9009\u62E9\u6587\u6863\u7C7B\u578B",value:t.searchParam.docType,"onUpdate:value":a[0]||(a[0]=i=>t.searchParam.docType=i),style:{width:"150px"}},{default:e(()=>[o(c,{value:""},{default:e(()=>[ue]),_:1}),o(c,{value:1},{default:e(()=>[_e]),_:1}),o(c,{value:2},{default:e(()=>[me]),_:1})]),_:1},8,["value"])]),_:1}),o(r,{label:"\u5F00\u653E\u8BBF\u95EE"},{default:e(()=>[o(_,{placeholder:"\u8BF7\u9009\u62E9\u5F00\u653E\u8BBF\u95EE",value:t.searchParam.openVisit,"onUpdate:value":a[1]||(a[1]=i=>t.searchParam.openVisit=i),style:{width:"150px"}},{default:e(()=>[o(c,{value:""},{default:e(()=>[pe]),_:1}),o(c,{value:0},{default:e(()=>[he]),_:1}),o(c,{value:1},{default:e(()=>[ge]),_:1})]),_:1},8,["value"])]),_:1}),o(r,{label:"\u72B6\u6001"},{default:e(()=>[o(_,{placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001",value:t.searchParam.docStatus,"onUpdate:value":a[2]||(a[2]=i=>t.searchParam.docStatus=i),style:{width:"150px"}},{default:e(()=>[o(c,{value:""},{default:e(()=>[fe]),_:1}),o(c,{value:1},{default:e(()=>[ve]),_:1}),o(c,{value:2},{default:e(()=>[ye]),_:1})]),_:1},8,["value"])]),_:1}),o(r,null,{default:e(()=>[o(m,{onClick:t.searchDocList,type:"primary"},{default:e(()=>[we]),_:1},8,["onClick"]),o(m,{onClick:t.openNewDoc,style:{marginLeft:"8px"}},{default:e(()=>[ke]),_:1},8,["onClick"])]),_:1})]),_:1}),o(v,{dataSource:t.docList,columns:t.docListColumns,size:"middle",loading:t.docListLoading,pagination:t.pagination,onChange:t.handleTableChange,scroll:{x:1400,y:"calc(100vh - 300px)"}},{bodyCell:e(({column:i,text:S,record:R})=>[i.dataIndex==="operation"?(u(),x(V,{key:0},[o(m,{size:"small",type:"link",onClick:P=>t.editDoc(R)},{default:e(()=>[be]),_:2},1032,["onClick"]),o(N,{title:"\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",onConfirm:P=>t.deleteDoc(R)},{default:e(()=>[o(m,{size:"small",type:"link",danger:""},{default:e(()=>[De]),_:1})]),_:2},1032,["onConfirm"]),o(z,{trigger:["click"]},{overlay:e(()=>[o(L,{onClick:P=>t.handleActionMenuClick(P,R)},{default:e(()=>[o(O,{key:"shareView"},{default:e(()=>[o(T),Se]),_:1}),o(O,{key:"shareInstruction"},{default:e(()=>[o(j),Ee]),_:1})]),_:2},1032,["onClick"])]),default:e(()=>[o(m,{type:"link",size:"small"},{default:e(()=>[Ce,o(A)]),_:1})]),_:2},1024)],64)):y("",!0),i.dataIndex==="docType"?(u(),x(V,{key:1},[S===1?(u(),p(l,{key:0,color:"red"},{default:e(()=>[Ue]),_:1})):S===2?(u(),p(l,{key:1,color:"blue"},{default:e(()=>[Ie]),_:1})):S===4?(u(),p(l,{key:2,color:"green"},{default:e(()=>[xe]),_:1})):y("",!0)],64)):y("",!0),i.dataIndex==="openVisit"?(u(),x(V,{key:2},[S===0?(u(),p(l,{key:0,color:"pink"},{default:e(()=>[Ve]),_:1})):S===1?(u(),p(l,{key:1,color:"green"},{default:e(()=>[Oe]),_:1})):y("",!0)],64)):y("",!0),i.dataIndex==="docStatus"?(u(),x(V,{key:3},[S===1?(u(),p(l,{key:0,color:"green"},{default:e(()=>[Le]),_:1})):S===2?(u(),p(l,{key:1,color:"pink"},{default:e(()=>[ze]),_:1})):y("",!0)],64)):y("",!0)]),_:1},8,["dataSource","columns","loading","pagination","onChange","scroll"]),o(G,{visible:t.newDocVisible,"onUpdate:visible":a[13]||(a[13]=i=>t.newDocVisible=i),title:t.docEdit.isNew?"\u65B0\u589E\u6587\u6863":"\u7F16\u8F91\u6587\u6863",onOk:t.handleNewDocOk,width:800},{default:e(()=>[o(b,{layout:"horizontal",ref:"newDocFormRef",rules:t.newDocRules,model:t.docEdit,"label-col":{span:4},"wrapper-col":{span:20}},{default:e(()=>[o(r,{label:"\u6587\u6863\u540D\u79F0",required:"",name:"name"},{default:e(()=>[o(D,{placeholder:"\u8BF7\u8F93\u5165\u6587\u6863\u540D\u79F0",value:t.docEdit.name,"onUpdate:value":a[3]||(a[3]=i=>t.docEdit.name=i)},null,8,["value"])]),_:1}),o(r,{label:"\u6587\u6863\u7C7B\u578B",required:"",name:"docType"},{default:e(()=>[o(q,{value:t.docEdit.docType,"onUpdate:value":a[4]||(a[4]=i=>t.docEdit.docType=i)},{default:e(()=>[o(g,{value:1},{default:e(()=>[Ne]),_:1}),o(g,{value:2},{default:e(()=>[Te]),_:1}),o(g,{value:3},{default:e(()=>[je]),_:1}),o(g,{value:4},{default:e(()=>[Ae]),_:1}),o(g,{value:5,disabled:""},{default:e(()=>[qe]),_:1})]),_:1},8,["value"])]),_:1}),t.docEdit.docType===1?(u(),p(r,{key:0,label:"\u6587\u6863\u5730\u5740",required:"",name:"docUrl"},{extra:e(()=>[Re,o(U,{title:"\u6587\u6863\u5730\u5740\u652F\u6301\u4EE5\u4E0B\u4EFB\u4E00\u683C\u5F0F"},{content:e(()=>[Pe,Be,Fe]),default:e(()=>[Je]),_:1})]),default:e(()=>[o(D,{placeholder:"\u8BF7\u8F93\u5165\u6587\u6863\u5730\u5740URL",value:t.docEdit.docUrl,"onUpdate:value":a[5]||(a[5]=i=>t.docEdit.docUrl=i)},null,8,["value"])]),_:1})):t.docEdit.docType===2?(u(),p(r,{key:1,label:"\u6587\u6863\u5185\u5BB9",required:"",name:"jsonContent"},{extra:e(()=>[Me,o(U,{title:"\u6587\u6863\u5185\u5BB9\u8BF4\u660E"},{content:e(()=>[We,W(s("div",null,[s("pre",null,[s("code",He,H(t.swaggerDocDemo),1)])],512),[[F]])]),default:e(()=>[Xe]),_:1})]),default:e(()=>[o(B,{value:t.docEdit.jsonContent,"onUpdate:value":a[6]||(a[6]=i=>t.docEdit.jsonContent=i),lang:"json",theme:"monokai",width:"100%",height:"100",options:t.aceEditorConfig},null,8,["value","options"])]),_:1})):y("",!0),t.docEdit.docType===3?(u(),p(r,{key:2,label:"\u6587\u6863\u5730\u5740",required:"",name:"docUrl"},{extra:e(()=>[Ze,o(U,{title:"\u6587\u6863\u5730\u5740\u652F\u6301\u4EE5\u4E0B\u4EFB\u4E00\u683C\u5F0F"},{content:e(()=>[Ge]),default:e(()=>[Ke]),_:1})]),default:e(()=>[o(D,{placeholder:"\u8BF7\u8F93\u5165\u6587\u6863\u5730\u5740URL",value:t.docEdit.docUrl,"onUpdate:value":a[7]||(a[7]=i=>t.docEdit.docUrl=i)},null,8,["value"])]),_:1})):t.docEdit.docType===4?(u(),p(r,{key:3,label:"\u6587\u6863\u5185\u5BB9",required:"",name:"jsonContent"},{extra:e(()=>[Qe,o(U,{title:"\u6587\u6863\u5185\u5BB9\u8BF4\u660E"},{content:e(()=>[Ye,W(s("div",null,[s("pre",null,[s("code",$e,H(t.openApiDocDemo),1)])],512),[[F]])]),default:e(()=>[et]),_:1})]),default:e(()=>[o(B,{value:t.docEdit.jsonContent,"onUpdate:value":a[8]||(a[8]=i=>t.docEdit.jsonContent=i),lang:"json",theme:"monokai",width:"100%",height:"100",options:t.aceEditorConfig},null,8,["value","options"])]),_:1})):y("",!0),o(r,{label:"\u76EE\u6807\u57DF\u540D",name:"rewriteDomain"},{extra:e(()=>[tt,o(U,{title:"\u76EE\u6807\u57DF\u540D\u8BF4\u660E"},{content:e(()=>[ot,at]),default:e(()=>[nt]),_:1})]),default:e(()=>[o(D,{placeholder:"\u8BF7\u8F93\u5165\u76EE\u6807\u57DF\u540D",value:t.docEdit.rewriteDomain,"onUpdate:value":a[9]||(a[9]=i=>t.docEdit.rewriteDomain=i)},null,8,["value"])]),_:1}),o(r,{label:"\u5F00\u653E\u8BBF\u95EE",required:"",name:"openVisit"},{extra:e(()=>[dt,s("a",{onClick:a[11]||(a[11]=i=>t.openShareViewWindow(t.docEdit))},"\u5F00\u653E\u6587\u6863URL"),rt]),default:e(()=>[o(q,{value:t.docEdit.openVisit,"onUpdate:value":a[10]||(a[10]=i=>t.docEdit.openVisit=i)},{default:e(()=>[o(g,{value:0},{default:e(()=>[lt]),_:1}),o(g,{value:1},{default:e(()=>[it]),_:1})]),_:1},8,["value"])]),_:1}),o(r,{label:"\u72B6\u6001",required:"",name:"docStatus"},{default:e(()=>[o(q,{value:t.docEdit.docStatus,"onUpdate:value":a[12]||(a[12]=i=>t.docEdit.docStatus=i)},{default:e(()=>[o(g,{value:1},{default:e(()=>[st]),_:1}),o(g,{value:2},{default:e(()=>[ct]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["visible","title","onOk"]),o(K,{ref:"instruction"},null,512)],64)}var ft=Z(ce,[["render",ut]]);export{ft as default};
