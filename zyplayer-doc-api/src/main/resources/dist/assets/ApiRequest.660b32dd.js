import{aa as Z,ab as ie,y as l,N as de,r as s,o as _,b as T,a,w as t,e as p,t as U,c as I,k as J,F as Q,m as n,ac as ue,ad as me,a5 as ce,v as ve,u as _e,O as fe,B as $,d as pe,Q as N,R as j}from"./vendor.59e47867.js";import"./index.e0fd63e3.js";import{P as ee,a as ae,u as ye,x as he}from"./unitConvert.36114cbf.js";import{z as X}from"./custom.46f9da77.js";import{a as Pe}from"./index.11b9cb38.js";import{_ as te}from"./main.48cb78d7.js";const ge={props:{result:{type:Object,required:!0},loading:{type:Boolean,required:!0}},components:{CloseOutlined:Z,ParamTable:ee,ParamBody:ae,aceEditor:Pe},setup(y){const{result:o}=ie(y);let x=l("body"),e=l("format"),h=l("json"),D=l(""),P=l([]),C=l([]),u=l(""),c=l(""),R=l({}),v=l();const w=()=>{e.value==="preview"&&setTimeout(()=>{v.value&&v.value.contentDocument.write(u.value)},0)},L=()=>{if(u.value="",c.value="",y.result.data){if(R.value=y.result.data,y.result.data.headers){P.value=y.result.data.headers;let i=P.value.find(S=>S.name==="Content-Type");i&&i.value&&(i.value.indexOf("text/html")>=0?h.value="html":i.value.indexOf("text/plain")>=0?h.value="text":i.value.indexOf("application/json")>=0?h.value="json":i.value.indexOf("application/xml")>=0||i.value.indexOf("text/xml")>=0?h.value="xml":i.value.indexOf("application/javascript")>=0&&(h.value="javascript"),D.value=h.value)}if(y.result.data.cookies&&(C.value=y.result.data.cookies),y.result.data.data){u.value=y.result.data.data,c.value=y.result.data.data;try{h.value==="xml"?c.value=he(u.value):h.value==="json"?c.value=JSON.stringify(JSON.parse(u.value),null,4):h.value==="javascript"&&(c.value=JSON.stringify(u.value,null,4))}catch{c.value=y.result.data.data}}else{let i=`
// \u8BF7\u6C42\u5931\u8D25\uFF0C\u4EE5\u4E0B\u4E3A\u5C01\u88C5\u7684\u8FD4\u56DE\u503C\u5BF9\u8C61\uFF0C\u4EC5\u4F9B\u53C2\u8003

`;u.value=i+JSON.stringify(y.result.data),c.value=i+JSON.stringify(y.result.data,null,4)}w()}};return L(),de(o,()=>L()),{activePage:x,bodyShowType:e,bodyShowTypeChange:w,unitConvert:ye,bodyShowFormatType:h,bodyShowFormatPreview:D,previewHtmlRef:v,resultData:R,resultHeaders:P,resultCookies:C,resultHeadersColumns:[{title:"KEY",dataIndex:"name"},{title:"VALUE",dataIndex:"value"}],resultCookiesColumns:[{title:"KEY",dataIndex:"name"},{title:"VALUE",dataIndex:"value"}],resultDataInit:i=>{i.setFontSize(16)},resultDataContentOrigin:u,resultDataContentFormat:c,resultDataConfig:{wrap:!0,readOnly:!0,autoScrollEditorIntoView:!0,enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0,minLines:30,maxLines:30}}}},be={key:0,style:{"margin-bottom":"30px"}},ke={key:0,style:{"margin-bottom":"30px"}},xe={style:{"margin-bottom":"10px"}},we=n("\u683C\u5F0F\u5316"),Se=n("\u539F\u59CB\u503C"),Re=n("\u9884\u89C8"),Le=n("JSON"),Ce=n("HTML"),Te=n("XML"),qe=n("JavaScript"),De=n("TEXT"),Oe={key:2},Ie={key:0,ref:"previewHtmlRef",width:"100%",height:"570px",style:{border:"0"}},Ee={class:"status-info-box"},Ue=n(" \u72B6\u6001\u7801\uFF1A"),Ne=n(" \u8017\u65F6\uFF1A"),je=n(" \u5927\u5C0F\uFF1A"),Ae={key:1},Ve={style:{color:"#f00"}},Ke={class:"status-info-box"},Be=n(" \u8017\u65F6\uFF1A"),Fe={key:1,style:{"margin-top":"20px"}},Je={key:2,style:{"margin-top":"20px",color:"#aaa"}};function He(y,o,x,e,h,D){const P=s("a-radio-button"),C=s("a-radio-group"),u=s("a-select-option"),c=s("a-select"),R=s("ace-editor"),v=s("a-tab-pane"),w=s("a-table"),L=s("a-divider"),g=s("a-tabs"),i=s("a-skeleton"),S=s("a-spin"),E=s("a-empty");return x.result.data?(_(),T("div",be,[x.result.data.data?(_(),T("div",ke,[a(g,{activeKey:e.activePage,"onUpdate:activeKey":o[4]||(o[4]=b=>e.activePage=b),onTabClick:o[5]||(o[5]=()=>{}),style:{padding:"5px 10px 0"}},{rightExtra:t(()=>[p("span",Ee,[Ue,p("span",null,U(e.resultData.status||"200"),1),a(L,{type:"vertical"}),Ne,p("span",null,U(e.unitConvert.formatSeconds(e.resultData.useTime||0)),1),a(L,{type:"vertical"}),je,p("span",null,U(e.unitConvert.formatFileSize(e.resultData.contentLength||0)),1)])]),default:t(()=>[a(v,{tab:"Body",key:"body",forceRender:""},{default:t(()=>[p("div",xe,[a(C,{value:e.bodyShowType,"onUpdate:value":o[0]||(o[0]=b=>e.bodyShowType=b),onChange:e.bodyShowTypeChange,size:"small"},{default:t(()=>[a(P,{value:"format"},{default:t(()=>[we]),_:1}),a(P,{value:"row"},{default:t(()=>[Se]),_:1}),a(P,{value:"preview"},{default:t(()=>[Re]),_:1})]),_:1},8,["value","onChange"]),e.bodyShowType==="format"?(_(),I(c,{key:0,value:e.bodyShowFormatType,"onUpdate:value":o[1]||(o[1]=b=>e.bodyShowFormatType=b),size:"small",style:{"margin-left":"10px",width:"100px"}},{default:t(()=>[a(u,{value:"json"},{default:t(()=>[Le]),_:1}),a(u,{value:"html"},{default:t(()=>[Ce]),_:1}),a(u,{value:"xml"},{default:t(()=>[Te]),_:1}),a(u,{value:"javascript"},{default:t(()=>[qe]),_:1}),a(u,{value:"text"},{default:t(()=>[De]),_:1})]),_:1},8,["value"])):J("",!0)]),e.bodyShowType==="format"?(_(),I(R,{key:0,value:e.resultDataContentFormat,"onUpdate:value":o[2]||(o[2]=b=>e.resultDataContentFormat=b),onInit:e.resultDataInit,lang:e.bodyShowFormatType,theme:"monokai",width:"100%",height:"100",options:e.resultDataConfig},null,8,["value","onInit","lang","options"])):e.bodyShowType==="row"?(_(),I(R,{key:1,value:e.resultDataContentOrigin,"onUpdate:value":o[3]||(o[3]=b=>e.resultDataContentOrigin=b),onInit:e.resultDataInit,lang:"text",theme:"chrome",width:"100%",height:"100",options:e.resultDataConfig},null,8,["value","onInit","options"])):e.bodyShowType==="preview"?(_(),T("div",Oe,[e.bodyShowFormatPreview==="html"?(_(),T("iframe",Ie,null,512)):(_(),T(Q,{key:1},[n(U(e.resultDataContentOrigin),1)],64))])):J("",!0)]),_:1}),a(v,{tab:"Headers",key:"headers",forceRender:""},{default:t(()=>[a(w,{dataSource:e.resultHeaders,columns:e.resultHeadersColumns,size:"small",pagination:!1,scroll:{y:"300px"}},null,8,["dataSource","columns"])]),_:1}),a(v,{tab:"Cookies",key:"cookies",forceRender:""},{default:t(()=>[a(w,{dataSource:e.resultCookies,columns:e.resultCookiesColumns,size:"small",pagination:!1,scroll:{y:"300px"}},null,8,["dataSource","columns"])]),_:1})]),_:1},8,["activeKey"])])):(_(),T("div",Ae,[a(g,{style:{padding:"5px 10px 0"}},{rightExtra:t(()=>[p("span",Ke,[Be,p("span",null,U(e.unitConvert.formatSeconds(e.resultData.useTime||0)),1)])]),default:t(()=>[a(v,{tab:"\u8BF7\u6C42\u5931\u8D25",key:"body",forceRender:""},{default:t(()=>[p("div",Ve,U(x.result.data.errorMsg),1)]),_:1})]),_:1})]))])):x.loading?(_(),T("div",Fe,[a(S,{tip:"\u8BF7\u6C42\u6267\u884C\u4E2D..."},{default:t(()=>[a(i)]),_:1})])):(_(),T("div",Je,[a(E,{description:"\u70B9\u51FB \u2018\u53D1\u9001\u8BF7\u6C42\u2019 \u83B7\u53D6\u8BF7\u6C42\u7ED3\u679C"})]))}var ze=te(ge,[["render",He]]);const Ge={components:{VerticalAlignTopOutlined:ue,VerticalAlignBottomOutlined:me,CloseOutlined:Z,SaveOutlined:ce,ParamTable:ee,ParamBody:ae,ApiRequestResult:ze},setup(y){let o=l("urlParam");const x=ve(),e=_e(),h={docId:x.query.id,requestId:x.query.requestId};let D=e.state.globalParam||[],P=1;const C=l();let u=l([]);const c=l();let R=l([]);const v=l();let w=l([]);const L=l();let g=l([]);const i=l();let S=l([]),E=l(),b=l("form"),H=l("json"),z=l({}),d=l({method:"get"}),G=l({}),K=l(!1);const oe=()=>{if(!d.value.apiUrl){$.error("\u8BF7\u8F93\u5165\u8BF7\u6C42\u7684\u76EE\u6807URL\u5730\u5740");return}const f=new FormData;let q=C.value.getSelectedRowKeys(),A=u.value.filter(r=>q.indexOf(r.key)>=0&&r.name&&r.value).map(r=>r.name+"="+encodeURIComponent(r.value)).join("&"),Y=c.value.getSelectedRowKeys(),V=R.value.filter(r=>Y.indexOf(r.key)>=0&&r.name&&r.value).map(r=>({code:r.name,value:r.value})),W=v.value.getSelectedRowKeys(),F=w.value.filter(r=>W.indexOf(r.key)>=0&&r.name&&r.value).map(r=>({code:r.name,value:r.value})),M=[];if(L.value){let r=L.value.getSelectedRowKeys();M=g.value.filter(k=>r.indexOf(k.key)>=0&&k.name&&k.value).map(k=>({code:k.name,value:k.value}))}let m=[];if(i.value){let r=i.value.getSelectedRowKeys();m=S.value.filter(k=>r.indexOf(k.key)>=0&&k.name&&k.value).map(k=>({code:k.name,value:k.value}))}let O="";E.value&&(O=E.value.getParam());let se=A?d.value.apiUrl+"?"+A:d.value.apiUrl;f.append("url",se),f.append("host",""),f.append("method",d.value.method),f.append("contentType",""),f.append("docId",h.docId),f.append("apiName",d.value.apiName),f.append("customRequestId",h.requestId),f.append("headerParam",JSON.stringify(V)),f.append("cookieParam",JSON.stringify(F)),f.append("formParam",JSON.stringify(M)),f.append("formEncodeParam",JSON.stringify(m)),f.append("bodyParam",O),K.value=!0,G.value={},X.requestUrl(f).then(r=>{G.value=r,K.value=!1}).catch(r=>{K.value=!1})};let B=l(!0);const le=()=>{B.value=!1},ne=()=>{B.value=!0},re=()=>{B.value=!0};return fe(async()=>{let f=await X.apiCustomRequestDetail({id:x.query.requestId}),q=f.data;q||console.log("\u6587\u6863\u52A0\u8F7D\u5931\u8D25",f),d.value=q,e.commit("addTableName",{key:x.fullPath,val:q.apiName});let A=[];D.filter(m=>m.paramType===2).forEach(m=>{A.push({name:m.paramKey,value:m.paramValue,type:"string",key:"g"+P++})}),q.headerData&&JSON.parse(q.headerData).forEach(O=>{A.unshift({name:O.code,value:O.value,type:"string",key:"g"+P++})}),R.value=A;let V=[];D.filter(m=>m.paramType===3).forEach(m=>{V.push({name:m.paramKey,value:m.paramValue,type:"string",key:"g"+P++})}),q.cookieData&&JSON.parse(q.cookieData).forEach(O=>{V.unshift({name:O.code,value:O.value,type:"string",key:"g"+P++})}),w.value=V;let F=[];D.filter(m=>m.paramType===1).forEach(m=>{F.push({name:m.paramKey,value:m.paramValue,type:"string",key:"g"+P++})}),g.value=F}),{activePage:o,activePageChange:re,requestLoading:K,sendRequest:oe,saveCustomRequest:()=>{X.apiCustomRequestAdd(d.value).then(f=>{$.success("\u4FDD\u5B58\u6210\u529F")})},requestResult:G,consumesParamType:H,urlParamRef:C,urlParamList:u,headerParamRef:c,headerParamList:R,cookieParamRef:v,cookieParamList:w,formParamRef:L,formParamList:g,formEncodeParamRef:i,formEncodeParamList:S,bodyParamRef:E,bodyParamType:b,bodyRowParamList:z,queryParamVisible:B,docInfoShow:d,hideQueryParam:le,showQueryParam:ne,methodList:["get","post","put","patch","head","delete","options","trace"]}}},Me={class:"api-name-box"},Qe=n(" \u4FDD\u5B58"),Xe=n("\u53D1\u9001\u8BF7\u6C42"),Ye={style:{"margin-bottom":"6px"}},We=n("none"),Ze=n("form-data"),$e=n("x-www-form-urlencoded"),ea=n("row"),aa=n("binary"),ta=n("JSON"),oa=n("HTML"),la=n("XML"),na=n("JavaScript"),ra=n("TEXT"),sa=n("\u6536\u8D77\u53C2\u6570"),ia=n("\u5C55\u5F00\u53C2\u6570");function da(y,o,x,e,h,D){const P=s("a-input"),C=s("a-col"),u=s("save-outlined"),c=s("a-button"),R=s("a-row"),v=s("a-select-option"),w=s("a-select"),L=s("a-input-search"),g=s("ParamTable"),i=s("a-tab-pane"),S=s("a-radio"),E=s("a-radio-group"),b=s("ParamBody"),H=s("a-tabs"),z=s("ApiRequestResult");return _(),T(Q,null,[p("div",Me,[a(R,{type:"flex"},{default:t(()=>[a(C,{flex:"auto"},{default:t(()=>[a(P,{value:e.docInfoShow.apiName,"onUpdate:value":o[0]||(o[0]=d=>e.docInfoShow.apiName=d),bordered:!1,placeholder:"\u8BF7\u8F93\u5165\u63A5\u53E3\u540D\u79F0"},null,8,["value"])]),_:1}),a(C,{flex:"88px"},{default:t(()=>[a(c,{onClick:e.saveCustomRequest,type:"dashed"},{default:t(()=>[a(u),Qe]),_:1},8,["onClick"])]),_:1})]),_:1})]),a(L,{value:e.docInfoShow.apiUrl,"onUpdate:value":o[2]||(o[2]=d=>e.docInfoShow.apiUrl=d),onSearch:e.sendRequest,placeholder:"\u8BF7\u8F93\u5165\u76EE\u6807URL\u5730\u5740"},{addonBefore:t(()=>[a(w,{value:e.docInfoShow.method,"onUpdate:value":o[1]||(o[1]=d=>e.docInfoShow.method=d),style:{width:"100px"}},{default:t(()=>[(_(!0),T(Q,null,pe(e.methodList,d=>(_(),I(v,{value:d},{default:t(()=>[n(U(d.toUpperCase()),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])]),enterButton:t(()=>[a(c,{type:"primary",loading:e.requestLoading},{default:t(()=>[Xe]),_:1},8,["loading"])]),_:1},8,["value","onSearch"]),a(H,{activeKey:e.activePage,"onUpdate:activeKey":o[5]||(o[5]=d=>e.activePage=d),closable:"",onTabClick:e.activePageChange,style:{padding:"5px 10px 0"}},{rightExtra:t(()=>[e.queryParamVisible?(_(),I(c,{key:0,onClick:e.hideQueryParam,type:"link"},{default:t(()=>[sa]),_:1},8,["onClick"])):(_(),I(c,{key:1,onClick:e.showQueryParam,type:"link"},{default:t(()=>[ia]),_:1},8,["onClick"]))]),default:t(()=>[a(i,{tab:"URL\u53C2\u6570",key:"urlParam",forceRender:""},{default:t(()=>[N(p("div",null,[a(g,{ref:"urlParamRef",paramList:e.urlParamList},null,8,["paramList"])],512),[[j,e.queryParamVisible]])]),_:1}),e.docInfoShow.method!=="get"?(_(),I(i,{tab:"Body\u53C2\u6570",key:"bodyParam",forceRender:""},{default:t(()=>[N(p("div",null,[p("div",Ye,[a(E,{value:e.bodyParamType,"onUpdate:value":o[3]||(o[3]=d=>e.bodyParamType=d)},{default:t(()=>[a(S,{value:"none"},{default:t(()=>[We]),_:1}),a(S,{value:"form"},{default:t(()=>[Ze]),_:1}),a(S,{value:"formUrlEncode"},{default:t(()=>[$e]),_:1}),a(S,{value:"row"},{default:t(()=>[ea]),_:1}),a(S,{value:"binary"},{default:t(()=>[aa]),_:1})]),_:1},8,["value"]),e.bodyParamType==="row"?(_(),I(w,{key:0,value:e.consumesParamType,"onUpdate:value":o[4]||(o[4]=d=>e.consumesParamType=d),size:"small",style:{"margin-left":"10px","vertical-align":"top",width:"100px"}},{default:t(()=>[a(v,{value:"json"},{default:t(()=>[ta]),_:1}),a(v,{value:"html"},{default:t(()=>[oa]),_:1}),a(v,{value:"xml"},{default:t(()=>[la]),_:1}),a(v,{value:"javascript"},{default:t(()=>[na]),_:1}),a(v,{value:"text"},{default:t(()=>[ra]),_:1})]),_:1},8,["value"])):J("",!0)]),N(p("div",null,[a(g,{ref:"formParamRef",paramList:e.formParamList,showType:""},null,8,["paramList"])],512),[[j,e.bodyParamType==="form"]]),N(p("div",null,[a(g,{ref:"formEncodeParamRef",paramList:e.formEncodeParamList},null,8,["paramList"])],512),[[j,e.bodyParamType==="formUrlEncode"]]),N(p("div",null,[a(b,{ref:"bodyParamRef",rowLang:e.consumesParamType,paramList:e.bodyRowParamList},null,8,["rowLang","paramList"])],512),[[j,e.bodyParamType==="row"]])],512),[[j,e.queryParamVisible]])]),_:1})):J("",!0),a(i,{tab:"Header\u53C2\u6570",key:"headerParam",forceRender:""},{default:t(()=>[N(p("div",null,[a(g,{ref:"headerParamRef",paramList:e.headerParamList},null,8,["paramList"])],512),[[j,e.queryParamVisible]])]),_:1}),a(i,{tab:"Cookie\u53C2\u6570",key:"cookieParam",forceRender:""},{default:t(()=>[N(p("div",null,[a(g,{ref:"cookieParamRef",paramList:e.cookieParamList},null,8,["paramList"])],512),[[j,e.queryParamVisible]])]),_:1})]),_:1},8,["activeKey","onTabClick"]),a(z,{result:e.requestResult,loading:e.requestLoading},null,8,["result","loading"])],64)}var ya=te(Ge,[["render",da]]);export{ya as default};
