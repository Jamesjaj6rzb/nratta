import{al as le,am as ge,y as o,G as Pe,r as u,o as y,b as T,a,w as t,e as p,t as N,c as I,k as F,F as se,m,an as be,ao as we,u as ie,J,L as j,d as Se,B as de,v as xe,H as Le}from"./vendor.5cdfcd20.js";import{D as ke,s as ue}from"./DocContent.87b51c9d.js";import{m as Oe}from"./mavon-editor.463f2be8.js";import{P as me,a as ce,u as De,x as Ce}from"./unitConvert.7d6894b9.js";import"./index.c860d973.js";import{g as Te,z as Re}from"./custom.9c7f1745.js";import{a as Ie}from"./index.dd427060.js";import{_ as Z}from"./main.635ba9a5.js";import"./logUtil.ba288f26.js";const qe={props:{result:{type:Object,required:!0},loading:{type:Boolean,required:!0}},components:{CloseOutlined:le,ParamTable:me,ParamBody:ce,aceEditor:Ie},setup(r){const{result:n}=ge(r);let w=o("body"),e=o("format"),_=o("json"),k=o(""),v=o([]),b=o([]),i=o(""),c=o(""),h=o({}),g=o();const d=()=>{e.value==="preview"&&setTimeout(()=>{g.value&&g.value.contentDocument.write(i.value)},0)},S=()=>{if(i.value="",c.value="",r.result.data){if(h.value=r.result.data,r.result.data.headers){v.value=r.result.data.headers;let f=v.value.find(D=>D.name==="Content-Type");f&&f.value&&(f.value.indexOf("text/html")>=0?_.value="html":f.value.indexOf("text/plain")>=0?_.value="text":f.value.indexOf("application/json")>=0?_.value="json":f.value.indexOf("application/xml")>=0||f.value.indexOf("text/xml")>=0?_.value="xml":f.value.indexOf("application/javascript")>=0&&(_.value="javascript"),k.value=_.value)}if(r.result.data.cookies&&(b.value=r.result.data.cookies),r.result.data.data||r.result.data.status===200){c.value=r.result.data.data,i.value=r.result.data.data;try{_.value==="xml"?c.value=Ce(i.value):_.value==="json"?c.value=JSON.stringify(JSON.parse(i.value),null,4):_.value==="javascript"&&(c.value=JSON.stringify(i.value,null,4))}catch{c.value=r.result.data.data}}else{let f=`
// \u8BF7\u6C42\u5931\u8D25\uFF0C\u4EE5\u4E0B\u4E3A\u5C01\u88C5\u7684\u8FD4\u56DE\u503C\u5BF9\u8C61\uFF0C\u4EC5\u4F9B\u53C2\u8003

`;i.value=f+JSON.stringify(r.result.data),c.value=f+JSON.stringify(r.result.data,null,4)}d()}};return S(),Pe(n,()=>S()),{activePage:w,bodyShowType:e,bodyShowTypeChange:d,unitConvert:De,bodyShowFormatType:_,bodyShowFormatPreview:k,previewHtmlRef:g,resultData:h,resultHeaders:v,resultCookies:b,resultHeadersColumns:[{title:"KEY",dataIndex:"name"},{title:"VALUE",dataIndex:"value"}],resultCookiesColumns:[{title:"KEY",dataIndex:"name"},{title:"VALUE",dataIndex:"value"}],resultDataInit:f=>{f.setFontSize(16)},resultDataContentOrigin:i,resultDataContentFormat:c,resultDataConfig:{wrap:!0,readOnly:!0,autoScrollEditorIntoView:!0,enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0,minLines:30,maxLines:30}}}},Ne={key:0,style:{"margin-bottom":"30px"}},Je={key:0,style:{"margin-bottom":"30px"}},je={style:{"margin-bottom":"10px"}},Ue=m("\u683C\u5F0F\u5316"),Ee=m("\u539F\u59CB\u503C"),Fe=m("\u9884\u89C8"),Ke=m("JSON"),Ve=m("HTML"),Ae=m("XML"),Be=m("JavaScript"),Me=m("TEXT"),He={key:2},ze={key:0,ref:"previewHtmlRef",width:"100%",height:"570px",style:{border:"0"}},Qe={class:"status-info-box"},Ge=m(" \u72B6\u6001\u7801\uFF1A"),Xe=m(" \u8017\u65F6\uFF1A"),Ye=m(" \u5927\u5C0F\uFF1A"),Ze={key:1},We={style:{color:"#f00"}},$e={class:"status-info-box"},ea=m(" \u8017\u65F6\uFF1A"),aa={key:1,style:{"margin-top":"20px"}},ta={key:2,style:{"margin-top":"20px",color:"#aaa"}};function oa(r,n,w,e,_,k){const v=u("a-radio-button"),b=u("a-radio-group"),i=u("a-select-option"),c=u("a-select"),h=u("ace-editor"),g=u("a-tab-pane"),d=u("a-table"),S=u("a-divider"),O=u("a-tabs"),f=u("a-skeleton"),D=u("a-spin"),L=u("a-empty");return w.result.data?(y(),T("div",Ne,[w.result.data.data||w.result.data.status===200?(y(),T("div",Je,[a(O,{activeKey:e.activePage,"onUpdate:activeKey":n[4]||(n[4]=x=>e.activePage=x),onTabClick:n[5]||(n[5]=()=>{}),style:{padding:"5px 10px 0"}},{rightExtra:t(()=>[p("span",Qe,[Ge,p("span",null,N(e.resultData.status||"200"),1),a(S,{type:"vertical"}),Xe,p("span",null,N(e.unitConvert.formatSeconds(e.resultData.useTime||0)),1),a(S,{type:"vertical"}),Ye,p("span",null,N(e.unitConvert.formatFileSize(e.resultData.contentLength||0)),1)])]),default:t(()=>[a(g,{tab:"Body",key:"body",forceRender:""},{default:t(()=>[p("div",je,[a(b,{value:e.bodyShowType,"onUpdate:value":n[0]||(n[0]=x=>e.bodyShowType=x),onChange:e.bodyShowTypeChange,size:"small"},{default:t(()=>[a(v,{value:"format"},{default:t(()=>[Ue]),_:1}),a(v,{value:"row"},{default:t(()=>[Ee]),_:1}),a(v,{value:"preview"},{default:t(()=>[Fe]),_:1})]),_:1},8,["value","onChange"]),e.bodyShowType==="format"?(y(),I(c,{key:0,value:e.bodyShowFormatType,"onUpdate:value":n[1]||(n[1]=x=>e.bodyShowFormatType=x),size:"small",style:{"margin-left":"10px",width:"100px"}},{default:t(()=>[a(i,{value:"json"},{default:t(()=>[Ke]),_:1}),a(i,{value:"html"},{default:t(()=>[Ve]),_:1}),a(i,{value:"xml"},{default:t(()=>[Ae]),_:1}),a(i,{value:"javascript"},{default:t(()=>[Be]),_:1}),a(i,{value:"text"},{default:t(()=>[Me]),_:1})]),_:1},8,["value"])):F("",!0)]),e.bodyShowType==="format"?(y(),I(h,{key:0,value:e.resultDataContentFormat,"onUpdate:value":n[2]||(n[2]=x=>e.resultDataContentFormat=x),onInit:e.resultDataInit,lang:e.bodyShowFormatType,theme:"monokai",width:"100%",height:"100",options:e.resultDataConfig},null,8,["value","onInit","lang","options"])):e.bodyShowType==="row"?(y(),I(h,{key:1,value:e.resultDataContentOrigin,"onUpdate:value":n[3]||(n[3]=x=>e.resultDataContentOrigin=x),onInit:e.resultDataInit,lang:"text",theme:"chrome",width:"100%",height:"100",options:e.resultDataConfig},null,8,["value","onInit","options"])):e.bodyShowType==="preview"?(y(),T("div",He,[e.bodyShowFormatPreview==="html"?(y(),T("iframe",ze,null,512)):(y(),T(se,{key:1},[m(N(e.resultDataContentOrigin),1)],64))])):F("",!0)]),_:1}),a(g,{tab:"Headers",key:"headers",forceRender:""},{default:t(()=>[a(d,{dataSource:e.resultHeaders,columns:e.resultHeadersColumns,size:"small",pagination:!1,scroll:{y:"300px"}},null,8,["dataSource","columns"])]),_:1}),a(g,{tab:"Cookies",key:"cookies",forceRender:""},{default:t(()=>[a(d,{dataSource:e.resultCookies,columns:e.resultCookiesColumns,size:"small",pagination:!1,scroll:{y:"300px"}},null,8,["dataSource","columns"])]),_:1})]),_:1},8,["activeKey"])])):(y(),T("div",Ze,[a(O,{style:{padding:"5px 10px 0"}},{rightExtra:t(()=>[p("span",$e,[ea,p("span",null,N(e.unitConvert.formatSeconds(e.resultData.useTime||0)),1)])]),default:t(()=>[a(g,{tab:"\u8BF7\u6C42\u5931\u8D25",key:"body",forceRender:""},{default:t(()=>[p("div",We,N(w.result.data.errorMsg),1)]),_:1})]),_:1})]))])):w.loading?(y(),T("div",aa,[a(D,{tip:"\u8BF7\u6C42\u6267\u884C\u4E2D..."},{default:t(()=>[a(f)]),_:1})])):(y(),T("div",ta,[a(L,{description:"\u70B9\u51FB \u2018\u53D1\u9001\u8BF7\u6C42\u2019 \u83B7\u53D6\u8BF7\u6C42\u7ED3\u679C"})]))}var ra=Z(qe,[["render",oa]]);const na={props:{docInfoShow:{type:Object,required:!0},requestParamList:{type:Array,required:!0},responseParamList:{type:Array,required:!0}},components:{VerticalAlignTopOutlined:be,VerticalAlignBottomOutlined:we,CloseOutlined:le,ParamTable:me,ParamBody:ce,DocDebuggerResult:ra},setup(r){const n=ie();let w=n.state.apiDoc||{},e=n.state.globalParam||[],_=n.state.swaggerDoc||{},k=w.rewriteDomain||_.host,v=o(k+r.docInfoShow.url),b=o("urlParam");const i=o();let c=r.requestParamList.filter(s=>s.in==="query"||s.in==="path"),h=o([]);const g=o();let d=e.filter(s=>s.paramType===2),S=r.requestParamList.filter(s=>s.in==="header"),O=1;d.forEach(s=>{S.push({name:s.paramKey,value:s.paramValue,type:"string",key:"g"+O++})});let f=o(JSON.parse(JSON.stringify(S)));const D=o();let L=e.filter(s=>s.paramType===3),x=r.requestParamList.filter(s=>s.in==="cookie");L.forEach(s=>{x.push({name:s.paramKey,value:s.paramValue,type:"string",key:"g"+O++})});let W=o(JSON.parse(JSON.stringify(x)));const B=o();let fe=e.filter(s=>s.paramType===1),C=r.requestParamList.filter(s=>s.in==="formData");fe.forEach(s=>{C.push({name:s.paramKey,value:s.paramValue,type:"string",key:"g"+O++})});let U=o([]);r.docInfoShow.method==="post"?C=C.concat(c):h=o(JSON.parse(JSON.stringify(c)));const M=o();let E=o([]),H=o(),q=o("form"),z=o("json"),$=r.requestParamList.filter(s=>s.in==="body"),ve=o(JSON.parse(JSON.stringify($)));r.docInfoShow.consumes.indexOf("application/x-www-form-urlencoded")>=0?(q.value="formUrlEncode",E=o(JSON.parse(JSON.stringify(C)))):r.docInfoShow.consumes.indexOf("multipart/form-data")>=0?(q.value="form",U=o(JSON.parse(JSON.stringify(C)))):r.docInfoShow.consumes.indexOf("application/json")>=0?(q.value="row",z.value="json",E=o(JSON.parse(JSON.stringify(C))),C.length>0&&(q.value="formUrlEncode")):r.docInfoShow.consumes.indexOf("application/xml")>=0||r.docInfoShow.consumes.indexOf("text/xml")>=0?(q.value="row",z.value="xml",E=o(JSON.parse(JSON.stringify(C))),C.length>0&&(q.value="formUrlEncode")):U=o(JSON.parse(JSON.stringify(C))),U.value.length>0?b.value="urlParam":C.length>0||$.length>0?b.value="bodyParam":S.length>0&&(b.value="headerParam");let Q=o({}),K=o(!1),ee=o({url:Te()+"/doc-swagger/proxy/download",param:{}}),ae=o(),te=r.docInfoShow.produces==="application/octet-stream";const ye=()=>{if(!v.value){de.error("\u8BF7\u8F93\u5165\u8BF7\u6C42\u7684\u76EE\u6807URL\u5730\u5740");return}let s={};const R=new FormData;let _e=i.value.getSelectedRowKeys(),oe=h.value.filter(l=>_e.indexOf(l.key)>=0&&l.name&&l.value).map(l=>(s[l.name]=l.value,l.name+"="+encodeURIComponent(l.value))).join("&"),pe=g.value.getSelectedRowKeys(),re=f.value.filter(l=>pe.indexOf(l.key)>=0&&l.name&&l.value).map(l=>({code:l.name,value:l.value})),he=D.value.getSelectedRowKeys(),ne=W.value.filter(l=>he.indexOf(l.key)>=0&&l.name&&l.value).map(l=>({code:l.name,value:l.value})),G=[];if(B.value){let l=B.value.getSelectedRowKeys();G=U.value.filter(P=>l.indexOf(P.key)>=0&&P.name&&P.value).map(P=>(s[P.name]=P.value,{code:P.name,value:P.value}))}let X=[];if(M.value){let l=M.value.getSelectedRowKeys();X=E.value.filter(P=>l.indexOf(P.key)>=0&&P.name&&P.value).map(P=>(s[P.name]=P.value,{code:P.name,value:P.value}))}let Y="";H.value&&(Y=H.value.getParam());let A=oe?v.value+"?"+oe:v.value;Object.keys(s).forEach(l=>{A=A.replace("{"+l+"}",s[l])}),te?(ee.value.param={url:A,host:k,method:r.docInfoShow.method,contentType:r.docInfoShow.consumes,headerParam:JSON.stringify(re),cookieParam:JSON.stringify(ne),formParam:JSON.stringify(G),formEncodeParam:JSON.stringify(X),bodyParam:Y},setTimeout(()=>ae.value.submit(),0)):(R.append("url",A),R.append("host",k),R.append("method",r.docInfoShow.method),R.append("contentType",r.docInfoShow.consumes),R.append("headerParam",JSON.stringify(re)),R.append("cookieParam",JSON.stringify(ne)),R.append("formParam",JSON.stringify(G)),R.append("formEncodeParam",JSON.stringify(X)),R.append("bodyParam",Y),K.value=!0,Q.value={},Re.requestUrl(R).then(l=>{Q.value=l,K.value=!1}).catch(l=>{K.value=!1}))};let V=o(!0);return{docUrl:v,activePage:b,activePageChange:()=>{V.value=!0},requestLoading:K,sendRequest:ye,requestResult:Q,consumesParamType:z,downloadFormParam:ee,downloadFormRef:ae,isDownloadRequest:te,urlParamRef:i,urlParamList:h,headerParamRef:g,headerParamList:f,cookieParamRef:D,cookieParamList:W,formParamRef:B,formParamList:U,formEncodeParamRef:M,formEncodeParamList:E,bodyParamRef:H,bodyParamType:q,bodyRowParamList:ve,responseCodeListColumns:[{title:"\u72B6\u6001\u7801",dataIndex:"code",width:100},{title:"\u7C7B\u578B",dataIndex:"type",width:250},{title:"\u8BF4\u660E",dataIndex:"desc"}],responseParamListColumns:[{title:"\u53C2\u6570\u540D",dataIndex:"name",width:250},{title:"\u7C7B\u578B",dataIndex:"type",width:250},{title:"\u8BF4\u660E",dataIndex:"description"}],queryParamVisible:V,hideQueryParam:()=>{V.value=!1},showQueryParam:()=>{V.value=!0}}}},la={style:{"margin-bottom":"6px"}},sa=m("none"),ia=m("form-data"),da=m("x-www-form-urlencoded"),ua=m("row"),ma=m("JSON"),ca=m("HTML"),fa=m("XML"),va=m("JavaScript"),ya=m("TEXT"),_a=m("\u6536\u8D77\u53C2\u6570"),pa=m("\u5C55\u5F00\u53C2\u6570"),ha=["action"],ga=["name","value"];function Pa(r,n,w,e,_,k){const v=u("a-button"),b=u("a-input-search"),i=u("ParamTable"),c=u("a-tab-pane"),h=u("a-radio"),g=u("a-radio-group"),d=u("a-select-option"),S=u("a-select"),O=u("ParamBody"),f=u("a-tabs"),D=u("DocDebuggerResult");return y(),T("div",null,[a(b,{"addon-before":w.docInfoShow.method.toUpperCase(),value:e.docUrl,"onUpdate:value":n[0]||(n[0]=L=>e.docUrl=L),onSearch:e.sendRequest,placeholder:"\u8BF7\u8F93\u5165\u76EE\u6807URL\u5730\u5740"},{enterButton:t(()=>[a(v,{type:"primary",loading:e.requestLoading},{default:t(()=>[m(N(e.isDownloadRequest?"\u4E0B\u8F7D\u6587\u4EF6":"\u53D1\u9001\u8BF7\u6C42"),1)]),_:1},8,["loading"])]),_:1},8,["addon-before","value","onSearch"]),a(f,{activeKey:e.activePage,"onUpdate:activeKey":n[3]||(n[3]=L=>e.activePage=L),closable:"",onTabClick:e.activePageChange,style:{padding:"5px 10px 0"}},{rightExtra:t(()=>[e.queryParamVisible?(y(),I(v,{key:0,onClick:e.hideQueryParam,type:"link"},{default:t(()=>[_a]),_:1},8,["onClick"])):(y(),I(v,{key:1,onClick:e.showQueryParam,type:"link"},{default:t(()=>[pa]),_:1},8,["onClick"]))]),default:t(()=>[a(c,{tab:"URL\u53C2\u6570",key:"urlParam",forceRender:""},{default:t(()=>[J(p("div",null,[a(i,{ref:"urlParamRef",paramList:e.urlParamList},null,8,["paramList"])],512),[[j,e.queryParamVisible]])]),_:1}),w.docInfoShow.method!=="get"?(y(),I(c,{tab:"Body\u53C2\u6570",key:"bodyParam",forceRender:""},{default:t(()=>[J(p("div",null,[p("div",la,[a(g,{value:e.bodyParamType,"onUpdate:value":n[1]||(n[1]=L=>e.bodyParamType=L)},{default:t(()=>[a(h,{value:"none"},{default:t(()=>[sa]),_:1}),a(h,{value:"form"},{default:t(()=>[ia]),_:1}),a(h,{value:"formUrlEncode"},{default:t(()=>[da]),_:1}),a(h,{value:"row"},{default:t(()=>[ua]),_:1})]),_:1},8,["value"]),e.bodyParamType==="row"?(y(),I(S,{key:0,value:e.consumesParamType,"onUpdate:value":n[2]||(n[2]=L=>e.consumesParamType=L),size:"small",style:{"margin-left":"10px","vertical-align":"top",width:"100px"}},{default:t(()=>[a(d,{value:"json"},{default:t(()=>[ma]),_:1}),a(d,{value:"html"},{default:t(()=>[ca]),_:1}),a(d,{value:"xml"},{default:t(()=>[fa]),_:1}),a(d,{value:"javascript"},{default:t(()=>[va]),_:1}),a(d,{value:"text"},{default:t(()=>[ya]),_:1})]),_:1},8,["value"])):F("",!0)]),J(p("div",null,[a(i,{ref:"formParamRef",paramList:e.formParamList,showType:""},null,8,["paramList"])],512),[[j,e.bodyParamType==="form"]]),J(p("div",null,[a(i,{ref:"formEncodeParamRef",paramList:e.formEncodeParamList},null,8,["paramList"])],512),[[j,e.bodyParamType==="formUrlEncode"]]),J(p("div",null,[a(O,{ref:"bodyParamRef",rowLang:e.consumesParamType,paramList:e.bodyRowParamList},null,8,["rowLang","paramList"])],512),[[j,e.bodyParamType==="row"]])],512),[[j,e.queryParamVisible]])]),_:1})):F("",!0),a(c,{tab:"Header\u53C2\u6570",key:"headerParam",forceRender:""},{default:t(()=>[J(p("div",null,[a(i,{ref:"headerParamRef",paramList:e.headerParamList},null,8,["paramList"])],512),[[j,e.queryParamVisible]])]),_:1}),a(c,{tab:"Cookie\u53C2\u6570",key:"cookieParam",forceRender:""},{default:t(()=>[J(p("div",null,[a(i,{ref:"cookieParamRef",paramList:e.cookieParamList},null,8,["paramList"])],512),[[j,e.queryParamVisible]])]),_:1})]),_:1},8,["activeKey","onTabClick"]),e.isDownloadRequest?F("",!0):(y(),I(D,{key:0,result:e.requestResult,loading:e.requestLoading},null,8,["result","loading"])),p("form",{method:"post",ref:"downloadFormRef",action:e.downloadFormParam.url,target:"_blank"},[(y(!0),T(se,null,Se(e.downloadFormParam.param,(L,x)=>(y(),T("input",{type:"hidden",name:x,value:L},null,8,ga))),256))],8,ha)])}var ba=Z(na,[["render",Pa]]);const wa={components:{DocContent:ke,DocDebugger:ba},setup(){const r=xe(),n=ie();let w=o("doc"),e=o([]),_=o([]),k=o({url:"",description:"",method:"",consumes:"",produces:""}),v=o(!1),b=0,i;const c=()=>{let g=r.query.path+"."+r.query.method;if(Object.keys(n.state.swaggerUrlMethodMap).length<=0){console.log("\u6587\u6863\u5C1A\u672A\u52A0\u8F7D\uFF0C\u7B49\u5F85\u52A0\u8F7D\u5B8C\u6210"),i||(i=setInterval(()=>{if(v.value||b++>50){clearInterval(i);return}Object.keys(n.state.swaggerUrlMethodMap).length>0&&(console.log("\u6587\u6863\u5185\u5BB9\u6539\u53D8\uFF0C\u91CD\u65B0\u52A0\u8F7D\u6587\u6863"),c())},1e3));return}let d=n.state.swaggerUrlMethodMap[g];if(!d){de.error("\u6CA1\u6709\u627E\u5230\u5BF9\u5E94\u7684\u6587\u6863");return}v.value=!0,n.commit("addTableName",{key:r.fullPath,val:d.summary});let S="",O="";d.consumes&&d.consumes.length>0&&(S=d.consumes.join(" ")),d.produces&&d.produces.length>0&&(O=d.produces.join(" "));let f=Oe.exports.markdownIt.render(d.description||d.summary||"");k.value={url:d.url,description:f,method:d.method||"",consumes:S,produces:O};let D=n.state.swaggerDefinitions;e.value=ue.getRequestParamList(d.parameters,D),_.value=ue.getResponseParamList(d.responses,D)};return Le(()=>{c()}),{docInfoShow:k,activePage:w,changePage:()=>{},isLoadSuccess:v,requestParamList:e,responseParamList:_}}},Sa=p("div",{style:{padding:"20px 0",height:"100px"}},null,-1);function xa(r,n,w,e,_,k){const v=u("DocContent"),b=u("a-tab-pane"),i=u("DocDebugger"),c=u("a-tabs"),h=u("a-spin");return e.isLoadSuccess?(y(),I(c,{key:0,activeKey:e.activePage,"onUpdate:activeKey":n[0]||(n[0]=g=>e.activePage=g),closable:"",onTabClick:e.changePage,style:{padding:"5px 10px 0"}},{default:t(()=>[a(b,{tab:"\u63A5\u53E3\u8BF4\u660E",key:"doc"},{default:t(()=>[a(v,{docInfoShow:e.docInfoShow,requestParamList:e.requestParamList,responseParamList:e.responseParamList},null,8,["docInfoShow","requestParamList","responseParamList"])]),_:1}),a(b,{tab:"\u5728\u7EBF\u8C03\u8BD5",key:"debug"},{default:t(()=>[a(i,{docInfoShow:e.docInfoShow,requestParamList:e.requestParamList,responseParamList:e.responseParamList},null,8,["docInfoShow","requestParamList","responseParamList"])]),_:1})]),_:1},8,["activeKey","onTabClick"])):(y(),I(h,{key:1,tip:"\u6587\u6863\u6570\u636E\u52A0\u8F7D\u4E2D..."},{default:t(()=>[Sa]),_:1}))}var Ua=Z(wa,[["render",xa]]);export{Ua as default};
